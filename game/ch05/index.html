<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì§ì—… íƒí—˜ëŒ€ - ì„¸ì‹¬ì´ì˜ ëª¨í—˜</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Noto+Sans+KR:wght@400;500;700;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(180deg, #87CEEB 0%, #E0F6FF 50%, #98D8AA 100%);
            min-height: 100vh;
            min-height: 100dvh;
            overflow: hidden;
            touch-action: none;
        }
        
        /* ê²Œì„ ì»¨í…Œì´ë„ˆ */
        #game-container {
            width: 100vw;
            height: 100vh;
            height: 100dvh;
            position: relative;
            overflow: hidden;
        }
        
        /* ì‹œì‘ í™”ë©´ */
        #start-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg, #FFE66D 0%, #FFB347 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
            transition: opacity 0.5s, visibility 0.5s;
            padding: 20px;
            overflow-y: auto;
        }
        
        #start-screen.hidden {
            opacity: 0;
            visibility: hidden;
        }
        
        .title-container {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .game-title {
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 700;
            font-size: clamp(2rem, 7vw, 3.5rem);
            color: #4A3728;
            text-shadow: 3px 3px 0 #FFE66D, 4px 4px 0 rgba(0,0,0,0.2);
            margin-bottom: 10px;
        }
        
        .game-subtitle {
            font-size: clamp(0.9rem, 2.5vw, 1.3rem);
            color: #6B5344;
            font-weight: 500;
        }
        
        /* ì„¸ì‹¬ì´ ìºë¦­í„° (CSSë¡œ êµ¬í˜„) */
        .sesim-character {
            width: 120px;
            height: 140px;
            position: relative;
            margin: 15px auto;
            animation: float 2s ease-in-out infinite;
            flex-shrink: 0;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .sesim-body {
            width: 100px;
            height: 100px;
            background: linear-gradient(180deg, #4A3728 0%, #4A3728 45%, #FFD93D 45%, #FFD93D 100%);
            border-radius: 50%;
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            border: 3px solid #3D2E1F;
        }
        
        .sesim-face {
            width: 70px;
            height: 50px;
            background: #FFE4B5;
            border-radius: 50%;
            position: absolute;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .sesim-eye {
            width: 8px;
            height: 10px;
            background: #2D2D2D;
            border-radius: 50%;
            position: absolute;
            top: 18px;
        }
        
        .sesim-eye.left { left: 18px; }
        .sesim-eye.right { right: 18px; }
        
        .sesim-mouth {
            width: 15px;
            height: 10px;
            background: #E85A4F;
            border-radius: 0 0 10px 10px;
            position: absolute;
            bottom: 12px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .sesim-cheek {
            width: 12px;
            height: 8px;
            background: #FFB6C1;
            border-radius: 50%;
            position: absolute;
            top: 28px;
            opacity: 0.7;
        }
        
        .sesim-cheek.left { left: 8px; }
        .sesim-cheek.right { right: 8px; }
        
        .sesim-antenna {
            width: 4px;
            height: 30px;
            background: #4A3728;
            position: absolute;
            top: -25px;
            border-radius: 2px;
        }
        
        .sesim-antenna.left { left: 35px; transform: rotate(-15deg); }
        .sesim-antenna.right { right: 35px; transform: rotate(15deg); }
        
        .sesim-antenna-ball {
            width: 14px;
            height: 14px;
            background: #FFD93D;
            border-radius: 50%;
            position: absolute;
            top: -8px;
            left: -5px;
            border: 2px solid #4A3728;
        }
        
        .sesim-wing {
            width: 35px;
            height: 45px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            position: absolute;
            top: 30px;
            border: 2px solid rgba(150, 150, 150, 0.3);
            animation: wingFlap 0.15s ease-in-out infinite alternate;
        }
        
        .sesim-wing.left { 
            left: -20px; 
            transform: rotate(-20deg);
        }
        .sesim-wing.right { 
            right: -20px; 
            transform: rotate(20deg);
            animation-delay: 0.075s;
        }
        
        @keyframes wingFlap {
            0% { transform: rotate(-20deg) scaleY(1); }
            100% { transform: rotate(-30deg) scaleY(0.9); }
        }
        
        .sesim-badge {
            width: 25px;
            height: 18px;
            background: #FFF;
            border: 1px solid #CCC;
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 2px;
            font-size: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
        }
        
        .start-btn {
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 500;
            font-size: clamp(1.2rem, 3.5vw, 1.6rem);
            padding: 12px 50px;
            background: linear-gradient(180deg, #4CAF50 0%, #388E3C 100%);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 6px 0 #2E7D32, 0 8px 20px rgba(0,0,0,0.3);
            transition: all 0.1s;
            margin-top: 20px;
        }
        
        .start-btn:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 #2E7D32, 0 4px 10px rgba(0,0,0,0.3);
        }
        
        .instructions {
            margin-top: 20px;
            text-align: center;
            color: #5D4E37;
            font-size: clamp(0.8rem, 2.2vw, 1rem);
            line-height: 1.7;
            background: rgba(255,255,255,0.5);
            padding: 12px 20px;
            border-radius: 15px;
            max-width: 90%;
        }
        
        /* ê²Œì„ í™”ë©´ */
        #game-screen {
            width: 100%;
            height: 100%;
            display: none;
            position: relative;
        }
        
        #game-screen.active {
            display: block;
        }
        
        /* ê²Œì„ ìº”ë²„ìŠ¤ */
        #game-canvas {
            width: 100%;
            height: 100%;
            display: block;
        }
        
        /* HUD */
        #hud {
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 15px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .hud-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-weight: 700;
            color: #4A3728;
            font-size: clamp(0.8rem, 2.2vw, 1rem);
        }
        
        .hud-icon {
            font-size: clamp(1rem, 2.5vw, 1.3rem);
        }
        
        /* ì¼ì‹œì •ì§€ ë²„íŠ¼ */
        #pause-btn {
            background: rgba(74, 55, 40, 0.9);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 6px 12px;
            font-size: clamp(0.75rem, 2vw, 0.9rem);
            font-weight: 500;
            cursor: pointer;
            font-family: 'Noto Sans KR', sans-serif;
        }
        
        #pause-btn:active {
            background: rgba(74, 55, 40, 0.7);
        }
        
        /* ì¼ì‹œì •ì§€ ëª¨ë‹¬ */
        #pause-modal {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: transparent;
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 60;
        }
        
        #pause-modal.active {
            display: flex;
        }
        
        .pause-box {
            background: linear-gradient(180deg, #FFF9E6 0%, #FFF 100%);
            border-radius: 25px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            border: 4px solid #FFD93D;
        }
        
        .pause-title {
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 700;
            font-size: clamp(1.5rem, 5vw, 2rem);
            color: #4A3728;
            margin-bottom: 25px;
        }
        
        .pause-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .pause-menu-btn {
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 500;
            font-size: clamp(1rem, 3vw, 1.2rem);
            padding: 12px 40px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            box-shadow: 0 4px 0 rgba(0,0,0,0.2);
        }
        
        .pause-menu-btn:active {
            transform: translateY(2px);
            box-shadow: 0 2px 0 rgba(0,0,0,0.2);
        }
        
        .pause-menu-btn.resume {
            background: linear-gradient(180deg, #4CAF50 0%, #388E3C 100%);
            color: white;
            box-shadow: 0 4px 0 #2E7D32;
        }
        
        .pause-menu-btn.restart {
            background: linear-gradient(180deg, #FF9800 0%, #F57C00 100%);
            color: white;
            box-shadow: 0 4px 0 #E65100;
        }
        
        /* í„°ì¹˜ ì»¨íŠ¸ë¡¤ */
        #touch-controls {
            position: absolute;
            bottom: max(20px, env(safe-area-inset-bottom, 20px));
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-between;
            padding: 0 20px;
            pointer-events: none;
        }
        
        .control-btn {
            width: clamp(55px, 14vw, 75px);
            height: clamp(55px, 14vw, 75px);
            background: rgba(255, 255, 255, 0.8);
            border: 3px solid #4A3728;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(1.3rem, 3.5vw, 1.8rem);
            color: #4A3728;
            pointer-events: auto;
            user-select: none;
            transition: all 0.1s;
        }
        
        .control-btn:active {
            background: #FFD93D;
            transform: scale(0.95);
        }
        
        .move-controls {
            display: flex;
            gap: 10px;
        }
        
        /* OX í€´ì¦ˆ ëª¨ë‹¬ */
        #quiz-modal {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 50;
            padding: 20px;
        }
        
        #quiz-modal.active {
            display: flex;
        }
        
        .quiz-box {
            background: linear-gradient(180deg, #FFF9E6 0%, #FFF 100%);
            border-radius: 25px;
            padding: 25px;
            max-width: 90%;
            width: 500px;
            max-height: 90vh;
            max-height: 90dvh;
            overflow-y: auto;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            border: 4px solid #FFD93D;
            animation: popIn 0.3s ease-out;
        }
        
        @keyframes popIn {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .quiz-title {
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 700;
            font-size: clamp(1.1rem, 3.5vw, 1.5rem);
            color: #4A3728;
            margin-bottom: 10px;
        }
        
        .quiz-job {
            font-size: clamp(0.9rem, 2.5vw, 1.1rem);
            color: #6B8E23;
            font-weight: 500;
            margin-bottom: 15px;
            padding: 6px 15px;
            background: #F0FFF0;
            border-radius: 20px;
            display: inline-block;
        }
        
        .quiz-question {
            font-size: clamp(1rem, 3vw, 1.2rem);
            color: #333;
            line-height: 1.6;
            margin-bottom: 20px;
            padding: 12px;
            background: #FFF;
            border-radius: 15px;
            border: 2px solid #EEE;
        }
        
        .quiz-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        
        .quiz-btn {
            width: clamp(70px, 18vw, 100px);
            height: clamp(70px, 18vw, 100px);
            border-radius: 50%;
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 700;
            font-size: clamp(1.8rem, 5vw, 2.5rem);
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 6px 0 rgba(0,0,0,0.2);
        }
        
        .quiz-btn.o-btn {
            background: linear-gradient(180deg, #4CAF50 0%, #388E3C 100%);
            color: white;
        }
        
        .quiz-btn.x-btn {
            background: linear-gradient(180deg, #F44336 0%, #D32F2F 100%);
            color: white;
        }
        
        .quiz-btn:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 rgba(0,0,0,0.2);
        }
        
        /* í€´ì¦ˆ ê²°ê³¼ */
        .quiz-result {
            display: none;
            padding: 15px;
            border-radius: 15px;
            margin-top: 15px;
            font-size: clamp(0.9rem, 2.5vw, 1.1rem);
            font-weight: 500;
        }
        
        .quiz-result.correct {
            display: block;
            background: #E8F5E9;
            color: #2E7D32;
            border: 2px solid #4CAF50;
        }
        
        .quiz-result.wrong {
            display: block;
            background: #FFEBEE;
            color: #C62828;
            border: 2px solid #F44336;
        }
        
        .retry-btn {
            margin-top: 12px;
            padding: 10px 25px;
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 500;
            font-size: clamp(0.9rem, 2.5vw, 1.1rem);
            background: #FF9800;
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            box-shadow: 0 4px 0 #F57C00;
        }
        
        .retry-btn:active {
            transform: translateY(2px);
            box-shadow: 0 2px 0 #F57C00;
        }
        
        /* í´ë¦¬ì–´ í™”ë©´ */
        #clear-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg, #FFE66D 0%, #FFB347 100%);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
            padding: 20px;
            overflow-y: auto;
        }
        
        #clear-screen.active {
            display: flex;
        }
        
        .clear-title {
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 700;
            font-size: clamp(2rem, 7vw, 3rem);
            color: #4A3728;
            text-shadow: 3px 3px 0 #FFE66D;
            margin-bottom: 15px;
            animation: bounce 0.6s ease-in-out infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }
        
        .clear-stats {
            background: rgba(255,255,255,0.9);
            padding: 20px 30px;
            border-radius: 20px;
            margin: 15px 0;
            text-align: center;
        }
        
        .stat-item {
            font-size: clamp(1rem, 2.5vw, 1.2rem);
            color: #4A3728;
            margin: 8px 0;
            font-weight: 500;
        }
        
        .achievement {
            background: linear-gradient(180deg, #FFD700 0%, #FFA500 100%);
            color: #4A3728;
            padding: 12px 25px;
            border-radius: 30px;
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 500;
            font-size: clamp(1rem, 3vw, 1.3rem);
            margin-top: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        /* ì§ì—… ì¹´ë“œ ìˆ˜ì§‘ í‘œì‹œ */
        .collected-jobs {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
            margin: 15px 0;
            max-width: 90%;
        }
        
        .job-card-mini {
            background: #FFF;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: clamp(0.75rem, 1.8vw, 0.9rem);
            color: #4A3728;
            border: 2px solid #4CAF50;
            font-weight: 500;
        }
        
        /* í´ë¦¬ì–´ í™”ë©´ ë²„íŠ¼ ì»¨í…Œì´ë„ˆ */
        .clear-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 15px;
        }
        
        .end-btn {
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 500;
            font-size: clamp(1rem, 3vw, 1.3rem);
            padding: 12px 40px;
            background: linear-gradient(180deg, #78909C 0%, #546E7A 100%);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 6px 0 #37474F, 0 8px 20px rgba(0,0,0,0.3);
            transition: all 0.1s;
        }
        
        .end-btn:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 #37474F, 0 4px 10px rgba(0,0,0,0.3);
        }
        
        /* í´ë¦¬ì–´ í™”ë©´ì˜ ì„¸ì‹¬ì´ ìºë¦­í„° í¬ê¸° ì¡°ì • */
        #clear-screen .sesim-character {
            width: 100px;
            height: 120px;
            margin: 10px auto;
        }
        
        #clear-screen .sesim-body {
            width: 85px;
            height: 85px;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <!-- ì‹œì‘ í™”ë©´ -->
        <div id="start-screen">
            <div class="title-container">
                <h1 class="game-title">ì§ì—… íƒí—˜ëŒ€</h1>
                <p class="game-subtitle">ì„¸ì‹¬ì´ì˜ ì†Œë“ ìœ í˜• ëŒ€ëª¨í—˜</p>
            </div>
            
            <!-- ì„¸ì‹¬ì´ ìºë¦­í„° -->
            <div class="sesim-character">
                <div class="sesim-body">
                    <div class="sesim-antenna left">
                        <div class="sesim-antenna-ball"></div>
                    </div>
                    <div class="sesim-antenna right">
                        <div class="sesim-antenna-ball"></div>
                    </div>
                    <div class="sesim-wing left"></div>
                    <div class="sesim-wing right"></div>
                    <div class="sesim-face">
                        <div class="sesim-eye left"></div>
                        <div class="sesim-eye right"></div>
                        <div class="sesim-cheek left"></div>
                        <div class="sesim-cheek right"></div>
                        <div class="sesim-mouth"></div>
                    </div>
                    <div class="sesim-badge">ì„¸ì‹¬</div>
                </div>
            </div>
            
            <button class="start-btn" onclick="startGame()">ê²Œì„ ì‹œì‘!</button>
            
            <div class="instructions">
                ğŸ® <strong>ì¡°ì‘ ë°©ë²•</strong><br>
                â—€ â–¶ ë²„íŠ¼ìœ¼ë¡œ ì´ë™ | â–² ë²„íŠ¼ìœ¼ë¡œ ì í”„<br><br>
                ğŸº <strong>ë¯¸ì…˜ í•­ì•„ë¦¬</strong>ë¥¼ ì°¾ì•„ OX í€´ì¦ˆë¥¼ í’€ì–´ë³´ì„¸ìš”!<br>
                ë‹¤ì–‘í•œ ì§ì—…ê³¼ ì†Œë“ ìœ í˜•ì„ ë°°ìš¸ ìˆ˜ ìˆì–´ìš”!
            </div>
        </div>
        
        <!-- ê²Œì„ í™”ë©´ -->
        <div id="game-screen">
            <canvas id="game-canvas"></canvas>
            
            <!-- HUD -->
            <div id="hud">
                <div class="hud-item">
                    <span class="hud-icon">ğŸº</span>
                    <span id="jar-count">0 / 7</span>
                </div>
                <button id="pause-btn" onclick="togglePause()">ì¼ì‹œì •ì§€</button>
                <div class="hud-item">
                    <span class="hud-icon">ğŸ’¼</span>
                    <span id="job-count">ìˆ˜ì§‘í•œ ì§ì—…: 0</span>
                </div>
            </div>
            
            <!-- í„°ì¹˜ ì»¨íŠ¸ë¡¤ -->
            <div id="touch-controls">
                <div class="move-controls">
                    <button class="control-btn" id="btn-left">â—€</button>
                    <button class="control-btn" id="btn-right">â–¶</button>
                </div>
                <button class="control-btn" id="btn-jump">â–²</button>
            </div>
            
            <!-- ì¼ì‹œì •ì§€ ëª¨ë‹¬ -->
            <div id="pause-modal">
                <div class="pause-box">
                    <h2 class="pause-title">â¸ï¸ ì¼ì‹œì •ì§€</h2>
                    <div class="pause-buttons">
                        <button class="pause-menu-btn resume" onclick="togglePause()">ê³„ì†í•˜ê¸°</button>
                        <button class="pause-menu-btn restart" onclick="restartFromPause()">ì²˜ìŒë¶€í„°</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- OX í€´ì¦ˆ ëª¨ë‹¬ -->
        <div id="quiz-modal">
            <div class="quiz-box">
                <h2 class="quiz-title">ğŸº ë¯¸ì…˜ í•­ì•„ë¦¬!</h2>
                <div class="quiz-job" id="quiz-job-name">íšŒì‚¬ì›</div>
                <p class="quiz-question" id="quiz-question">
                    íšŒì‚¬ì›ì˜ ì›”ê¸‰ì€ ê·¼ë¡œì†Œë“ì´ë‹¤.
                </p>
                <div class="quiz-buttons" id="quiz-buttons">
                    <button class="quiz-btn o-btn" onclick="answerQuiz(true)">O</button>
                    <button class="quiz-btn x-btn" onclick="answerQuiz(false)">X</button>
                </div>
                <div class="quiz-result" id="quiz-result"></div>
            </div>
        </div>
        
        <!-- í´ë¦¬ì–´ í™”ë©´ -->
        <div id="clear-screen">
            <h1 class="clear-title">ğŸ‰ ê²Œì„ í´ë¦¬ì–´! ğŸ‰</h1>
            
            <div class="sesim-character">
                <div class="sesim-body">
                    <div class="sesim-antenna left">
                        <div class="sesim-antenna-ball"></div>
                    </div>
                    <div class="sesim-antenna right">
                        <div class="sesim-antenna-ball"></div>
                    </div>
                    <div class="sesim-wing left"></div>
                    <div class="sesim-wing right"></div>
                    <div class="sesim-face">
                        <div class="sesim-eye left"></div>
                        <div class="sesim-eye right"></div>
                        <div class="sesim-cheek left"></div>
                        <div class="sesim-cheek right"></div>
                        <div class="sesim-mouth"></div>
                    </div>
                    <div class="sesim-badge">ì„¸ì‹¬</div>
                </div>
            </div>
            
            <div class="clear-stats">
                <div class="stat-item">âœ… í†µê³¼í•œ ë¯¸ì…˜: 7 / 7</div>
                <div class="stat-item" id="collected-count">ğŸ’¼ ìˆ˜ì§‘í•œ ì§ì—…: 7ê°œ</div>
            </div>
            
            <div class="collected-jobs" id="collected-jobs-list">
                <!-- ìˆ˜ì§‘í•œ ì§ì—… ì¹´ë“œë“¤ -->
            </div>
            
            <div class="achievement">ğŸ† ì§ì—… íƒí—˜ê°€ ì¹­í˜¸ íšë“!</div>
            
            <div class="clear-buttons">
                <button class="start-btn" onclick="restartGame()">ë‹¤ì‹œ í•˜ê¸°</button>
                <button class="end-btn" onclick="endGame()">ê²Œì„ ì¢…ë£Œ</button>
            </div>
        </div>
    </div>

    <script>
        // ê²Œì„ ìƒíƒœ
        const gameState = {
            isPlaying: false,
            isPaused: false,
            completedJars: 0,
            collectedJobs: [],
            currentQuiz: null
        };

        // ìº”ë²„ìŠ¤ ë° ì»¨í…ìŠ¤íŠ¸
        let canvas, ctx;
        let canvasWidth, canvasHeight;

        // ê²Œì„ ì˜¤ë¸Œì íŠ¸
        let player, platforms, jars, decorations;
        let cameraX = 0;
        const WORLD_WIDTH = 5000;

        // ì»¨íŠ¸ë¡¤ ìƒíƒœ
        const controls = {
            left: false,
            right: false,
            jump: false
        };

        // ê²Œì„ ë£¨í”„ ID
        let gameLoopId = null;

        // ì§ì—… ë° í€´ì¦ˆ ë°ì´í„°
        const jobQuizzes = [
            {
                job: "íšŒì‚¬ì›",
                incomeType: "ê·¼ë¡œì†Œë“",
                question: "íšŒì‚¬ì›ì˜ ì›”ê¸‰ì€ ê·¼ë¡œì†Œë“ì´ë‹¤.",
                answer: true,
                explanation: "íšŒì‚¬ì—ì„œ ì¼í•˜ê³  ë°›ëŠ” ì›”ê¸‰ì€ ê·¼ë¡œì†Œë“ìœ¼ë¡œ ë¶„ë¥˜ë©ë‹ˆë‹¤."
            },
            {
                job: "ì„¸ë¬´ì‚¬",
                incomeType: "ì‚¬ì—…ì†Œë“",
                question: "ì„¸ë¬´ì‚¬ëŠ” ê¸°ì—…ì˜ íšŒê³„ ì¥ë¶€ë¥¼ ê°ì‚¬í•˜ëŠ” ì „ë¬¸ê°€ì´ë‹¤.",
                answer: false,
                explanation: "ê¸°ì—…ì˜ íšŒê³„ ë° ì¬ë¬´ê¸°ë¡ì˜ ì •í™•ì„±ì„ í™•ì¸í•˜ê¸° ìœ„í•´ ê¸°ì—…ì˜ ì¥ë¶€ë¥¼ ê°ì‚¬í•˜ëŠ” ê²ƒì€ ê³µì¸íšŒê³„ì‚¬ì˜ ì—­í• ì…ë‹ˆë‹¤. ì„¸ë¬´ì‚¬ëŠ” ìì˜ì—…ìë‚˜ ê°œì¸ ë“±ì´ ì„¸ê¸ˆ ì‹ ê³ ë¥¼ ì–´ë ¤ì›Œí•  ë•Œ, ì‹ ê³ ë¥¼ ëŒ€ì‹  ì²˜ë¦¬í•˜ê³  ë‚©ì„¸ ì˜ë¬´ ì´í–‰ì„ ë„ì™€ì£¼ëŠ” ì „ë¬¸ê°€ì˜ˆìš”."
            },
            {
                job: "ìœ íŠœë²„",
                incomeType: "ì‚¬ì—…ì†Œë“",
                question: "ìœ íŠœë²„ì˜ ê´‘ê³  ìˆ˜ì…ì€ ì‚¬ì—…ì†Œë“ìœ¼ë¡œ ë¶„ë¥˜ëœë‹¤.",
                answer: true,
                explanation: "ìœ íŠœë²„ëŠ” ê°œì¸ ì‚¬ì—…ìë¡œì„œ ì‚¬ì—…ì†Œë“ì„ ì–»ìŠµë‹ˆë‹¤."
            },
            {
                job: "ê³µì¸íšŒê³„ì‚¬",
                incomeType: "ì‚¬ì—…ì†Œë“",
                question: "ê³µì¸íšŒê³„ì‚¬ëŠ” ê¸°ì—…ì˜ ì¬ë¬´ì œí‘œê°€ ì •í™•í•œì§€ í™•ì¸í•˜ëŠ” ì „ë¬¸ê°€ì´ë‹¤.",
                answer: true,
                explanation: "ê³µì¸íšŒê³„ì‚¬(CPA)ëŠ” ê¸°ì—…ì˜ íšŒê³„ ì¥ë¶€ë¥¼ ê°ì‚¬í•˜ì—¬ íˆ¬ììì™€ ì •ë¶€ê°€ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤."
            },
            {
                job: "ì¹´í˜ ì‚¬ì¥",
                incomeType: "ì‚¬ì—…ì†Œë“",
                question: "ì¹´í˜ë¥¼ ìš´ì˜í•˜ë©° ì–»ëŠ” ìˆ˜ì…ì€ ê·¼ë¡œì†Œë“ì´ë‹¤.",
                answer: false,
                explanation: "ê°€ê²Œë¥¼ ì§ì ‘ ìš´ì˜í•˜ì—¬ ì–»ëŠ” ìˆ˜ì…ì€ ì‚¬ì—…ì†Œë“ì…ë‹ˆë‹¤."
            },
            {
                job: "êµ­ì„¸ì²­ ê³µë¬´ì›",
                incomeType: "ê·¼ë¡œì†Œë“",
                question: "êµ­ì„¸ì²­ ê³µë¬´ì›ì€ íƒˆì„¸ë¥¼ ì¡°ì‚¬í•˜ê³  ê³µì •í•œ ì„¸ê¸ˆ ì œë„ë¥¼ ì§€í‚¤ëŠ” ì—­í• ì„ í•œë‹¤.",
                answer: true,
                explanation: "êµ­ì„¸ì²­ ê³µë¬´ì›ì€ ì„¸ê¸ˆì„ ì§•ìˆ˜í•˜ê³  ë¶€ì •í–‰ìœ„ë¥¼ ì¡°ì‚¬í•˜ì—¬ ê³µì •í•œ ì‚¬íšŒë¥¼ ë§Œë“­ë‹ˆë‹¤."
            },
            {
                job: "ì€í‡´ì",
                incomeType: "ì—°ê¸ˆì†Œë“",
                question: "ì€í‡´ í›„ ë°›ëŠ” êµ­ë¯¼ì—°ê¸ˆì€ ì—°ê¸ˆì†Œë“ì„¸ê°€ ë¶€ê³¼ëœë‹¤.",
                answer: true,
                explanation: "ì—°ê¸ˆì„ ë°›ìœ¼ë©´ ì—°ê¸ˆì†Œë“ìœ¼ë¡œ ë¶„ë¥˜ë˜ì–´ ì—°ê¸ˆì†Œë“ì„¸ë¥¼ ë‚´ì•¼ í•©ë‹ˆë‹¤."
            }
        ];

        // ìƒ‰ìƒ í…Œë§ˆ
        const colors = {
            sky: '#87CEEB',
            grass: '#4CAF50',
            dirt: '#8B4513',
            platform: '#A0522D',
            platformTop: '#228B22',
            jar: '#D2691E',
            jarHighlight: '#FFD700'
        };

        // í”Œë ˆì´ì–´ í´ë˜ìŠ¤
        class Player {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.width = 50;
                this.height = 60;
                this.vx = 0;
                this.vy = 0;
                this.speed = 5;
                this.jumpPower = -13.5;  // -15ì—ì„œ -13.5ë¡œ ë³€ê²½ (ì í”„ ë†’ì´ ê°ì†Œ)
                this.gravity = 0.65;    // 0.6ì—ì„œ 0.65ë¡œ ë³€ê²½ (ì•½ê°„ ë” ë¹ ë¥´ê²Œ ë–¨ì–´ì§)
                this.isGrounded = false;
                this.facingRight = true;
                this.wingAngle = 0;
            }

            update() {
                // ì¢Œìš° ì´ë™
                if (controls.left) {
                    this.vx = -this.speed;
                    this.facingRight = false;
                } else if (controls.right) {
                    this.vx = this.speed;
                    this.facingRight = true;
                } else {
                    this.vx = 0;
                }

                // ì í”„
                if (controls.jump && this.isGrounded) {
                    this.vy = this.jumpPower;
                    this.isGrounded = false;
                }

                // ì¤‘ë ¥ ì ìš©
                this.vy += this.gravity;

                // ìœ„ì¹˜ ì—…ë°ì´íŠ¸
                this.x += this.vx;
                this.y += this.vy;

                // í™”ë©´ ê²½ê³„
                if (this.x < 0) this.x = 0;
                if (this.x > WORLD_WIDTH - this.width) this.x = WORLD_WIDTH - this.width;

                // í”Œë«í¼ ì¶©ëŒ
                this.isGrounded = false;
                for (let platform of platforms) {
                    if (this.checkPlatformCollision(platform)) {
                        this.y = platform.y - this.height;
                        this.vy = 0;
                        this.isGrounded = true;
                    }
                }

                // ë°”ë‹¥ ì¶©ëŒ
                const groundY = canvasHeight - 80;
                if (this.y + this.height > groundY) {
                    this.y = groundY - this.height;
                    this.vy = 0;
                    this.isGrounded = true;
                }

                // ë‚ ê°œ ì• ë‹ˆë©”ì´ì…˜
                this.wingAngle += 0.3;
            }

            checkPlatformCollision(platform) {
                const wasAbove = (this.y + this.height - this.vy) <= platform.y;
                const isNowBelow = (this.y + this.height) >= platform.y;
                const horizontalOverlap = 
                    this.x + this.width > platform.x && 
                    this.x < platform.x + platform.width;
                
                return wasAbove && isNowBelow && this.vy >= 0 && horizontalOverlap &&
                       this.y + this.height <= platform.y + 20;
            }

            draw(ctx) {
                const screenX = this.x - cameraX;
                const centerX = screenX + this.width / 2;
                const centerY = this.y + this.height / 2;

                ctx.save();
                
                if (!this.facingRight) {
                    ctx.translate(centerX, 0);
                    ctx.scale(-1, 1);
                    ctx.translate(-centerX, 0);
                }

                // ë‚ ê°œ
                ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
                ctx.strokeStyle = 'rgba(150, 150, 150, 0.5)';
                ctx.lineWidth = 2;
                
                const wingOffset = Math.sin(this.wingAngle) * 3;
                
                // ì™¼ìª½ ë‚ ê°œ
                ctx.beginPath();
                ctx.ellipse(screenX - 5, this.y + 25 + wingOffset, 18, 25, -0.3, 0, Math.PI * 2);
                ctx.fill();
                ctx.stroke();
                
                // ì˜¤ë¥¸ìª½ ë‚ ê°œ
                ctx.beginPath();
                ctx.ellipse(screenX + this.width + 5, this.y + 25 - wingOffset, 18, 25, 0.3, 0, Math.PI * 2);
                ctx.fill();
                ctx.stroke();

                // ëª¸í†µ (ê°ˆìƒ‰ ìƒë‹¨ + ë…¸ë€ìƒ‰ í•˜ë‹¨)
                ctx.beginPath();
                ctx.arc(centerX, centerY + 5, 28, 0, Math.PI * 2);
                ctx.fillStyle = '#4A3728';
                ctx.fill();
                ctx.strokeStyle = '#3D2E1F';
                ctx.lineWidth = 2;
                ctx.stroke();

                // ë…¸ë€ ë°°
                ctx.beginPath();
                ctx.arc(centerX, centerY + 15, 22, 0.2, Math.PI - 0.2);
                ctx.fillStyle = '#FFD93D';
                ctx.fill();

                // ì–¼êµ´
                ctx.beginPath();
                ctx.ellipse(centerX, this.y + 22, 20, 16, 0, 0, Math.PI * 2);
                ctx.fillStyle = '#FFE4B5';
                ctx.fill();

                // ëˆˆ
                ctx.fillStyle = '#2D2D2D';
                ctx.beginPath();
                ctx.ellipse(centerX - 8, this.y + 20, 4, 5, 0, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.ellipse(centerX + 8, this.y + 20, 4, 5, 0, 0, Math.PI * 2);
                ctx.fill();

                // ë³¼í„°ì¹˜
                ctx.fillStyle = 'rgba(255, 182, 193, 0.6)';
                ctx.beginPath();
                ctx.ellipse(centerX - 15, this.y + 26, 5, 3, 0, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.ellipse(centerX + 15, this.y + 26, 5, 3, 0, 0, Math.PI * 2);
                ctx.fill();

                // ì…
                ctx.fillStyle = '#E85A4F';
                ctx.beginPath();
                ctx.arc(centerX, this.y + 30, 5, 0, Math.PI);
                ctx.fill();

                // ë”ë“¬ì´
                ctx.strokeStyle = '#4A3728';
                ctx.lineWidth = 3;
                
                ctx.beginPath();
                ctx.moveTo(centerX - 10, this.y + 8);
                ctx.lineTo(centerX - 15, this.y - 12);
                ctx.stroke();
                
                ctx.beginPath();
                ctx.moveTo(centerX + 10, this.y + 8);
                ctx.lineTo(centerX + 15, this.y - 12);
                ctx.stroke();

                // ë”ë“¬ì´ ë ê³µ
                ctx.fillStyle = '#FFD93D';
                ctx.strokeStyle = '#4A3728';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.arc(centerX - 15, this.y - 14, 7, 0, Math.PI * 2);
                ctx.fill();
                ctx.stroke();
                ctx.beginPath();
                ctx.arc(centerX + 15, this.y - 14, 7, 0, Math.PI * 2);
                ctx.fill();
                ctx.stroke();

                // ëª…ì°°
                ctx.fillStyle = '#FFF';
                ctx.fillRect(centerX - 10, this.y + 45, 20, 12);
                ctx.strokeStyle = '#CCC';
                ctx.lineWidth = 1;
                ctx.strokeRect(centerX - 10, this.y + 45, 20, 12);
                ctx.fillStyle = '#666';
                ctx.font = '6px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('ì„¸ì‹¬', centerX, this.y + 54);

                ctx.restore();
            }
        }

        // í”Œë«í¼ í´ë˜ìŠ¤
        class Platform {
            constructor(x, y, width, height) {
                this.x = x;
                this.y = y;
                this.width = width;
                this.height = height || 25;
            }

            draw(ctx) {
                const screenX = this.x - cameraX;
                
                // í”Œë«í¼ì´ í™”ë©´ì— ë³´ì´ëŠ”ì§€ í™•ì¸
                if (screenX + this.width < 0 || screenX > canvasWidth) return;

                // í”Œë«í¼ ëª¸ì²´
                ctx.fillStyle = '#8B4513';
                ctx.fillRect(screenX, this.y, this.width, this.height);
                
                // ì”ë”” ìƒë‹¨
                ctx.fillStyle = '#228B22';
                ctx.fillRect(screenX, this.y, this.width, 8);
                
                // í•˜ì´ë¼ì´íŠ¸
                ctx.fillStyle = 'rgba(255,255,255,0.2)';
                ctx.fillRect(screenX, this.y, this.width, 3);
            }
        }

        // ë¯¸ì…˜ í•­ì•„ë¦¬ í´ë˜ìŠ¤
        class Jar {
            constructor(x, y, quizIndex) {
                this.x = x;
                this.y = y;
                this.width = 50;
                this.height = 60;
                this.quizIndex = quizIndex;
                this.completed = false;
                this.bobOffset = Math.random() * Math.PI * 2;
                this.glowIntensity = 0;
            }

            update() {
                this.bobOffset += 0.05;
                this.glowIntensity = (Math.sin(this.bobOffset * 2) + 1) / 2;
            }

            draw(ctx) {
                if (this.completed) return;

                const screenX = this.x - cameraX;
                if (screenX + this.width < 0 || screenX > canvasWidth) return;

                const bobY = this.y + Math.sin(this.bobOffset) * 3;

                // ë¹›ë‚˜ëŠ” íš¨ê³¼
                const gradient = ctx.createRadialGradient(
                    screenX + this.width/2, bobY + this.height/2, 0,
                    screenX + this.width/2, bobY + this.height/2, 50
                );
                gradient.addColorStop(0, `rgba(255, 215, 0, ${0.3 + this.glowIntensity * 0.3})`);
                gradient.addColorStop(1, 'rgba(255, 215, 0, 0)');
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(screenX + this.width/2, bobY + this.height/2, 50, 0, Math.PI * 2);
                ctx.fill();

                // í•­ì•„ë¦¬ ëª¸ì²´
                ctx.fillStyle = '#D2691E';
                ctx.beginPath();
                ctx.moveTo(screenX + 5, bobY + 20);
                ctx.quadraticCurveTo(screenX - 5, bobY + 40, screenX + 10, bobY + this.height);
                ctx.lineTo(screenX + this.width - 10, bobY + this.height);
                ctx.quadraticCurveTo(screenX + this.width + 5, bobY + 40, screenX + this.width - 5, bobY + 20);
                ctx.closePath();
                ctx.fill();

                // í•­ì•„ë¦¬ ëª©
                ctx.fillStyle = '#B8860B';
                ctx.fillRect(screenX + 12, bobY + 5, this.width - 24, 20);

                // í•­ì•„ë¦¬ ì…êµ¬
                ctx.fillStyle = '#8B4513';
                ctx.beginPath();
                ctx.ellipse(screenX + this.width/2, bobY + 5, 18, 6, 0, 0, Math.PI * 2);
                ctx.fill();

                // ë¬¼ìŒí‘œ ë§ˆí¬
                ctx.fillStyle = '#FFD700';
                ctx.font = 'bold 24px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('?', screenX + this.width/2, bobY + 45);

                // í•˜ì´ë¼ì´íŠ¸
                ctx.fillStyle = 'rgba(255,255,255,0.3)';
                ctx.beginPath();
                ctx.ellipse(screenX + 18, bobY + 35, 5, 10, -0.3, 0, Math.PI * 2);
                ctx.fill();
            }

            checkCollision(player) {
                if (this.completed) return false;
                return player.x < this.x + this.width &&
                       player.x + player.width > this.x &&
                       player.y < this.y + this.height &&
                       player.y + player.height > this.y;
            }
        }

        // ì¥ì‹ ìš”ì†Œ í´ë˜ìŠ¤
        class Decoration {
            constructor(x, y, type) {
                this.x = x;
                this.y = y;
                this.type = type;
            }

            draw(ctx) {
                const screenX = this.x - cameraX;
                if (screenX < -100 || screenX > canvasWidth + 100) return;

                switch(this.type) {
                    case 'tree':
                        this.drawTree(ctx, screenX);
                        break;
                    case 'flower':
                        this.drawFlower(ctx, screenX);
                        break;
                    case 'bush':
                        this.drawBush(ctx, screenX);
                        break;
                    case 'cloud':
                        this.drawCloud(ctx, screenX);
                        break;
                    case 'building':
                        this.drawBuilding(ctx, screenX);
                        break;
                }
            }

            drawTree(ctx, screenX) {
                // ë‚˜ë¬´ ì¤„ê¸°
                ctx.fillStyle = '#8B4513';
                ctx.fillRect(screenX - 10, this.y - 80, 20, 80);
                
                // ë‚˜ë­‡ì
                ctx.fillStyle = '#228B22';
                ctx.beginPath();
                ctx.arc(screenX, this.y - 100, 40, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(screenX - 25, this.y - 80, 30, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(screenX + 25, this.y - 80, 30, 0, Math.PI * 2);
                ctx.fill();
            }

            drawFlower(ctx, screenX) {
                // ì¤„ê¸°
                ctx.strokeStyle = '#228B22';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(screenX, this.y);
                ctx.lineTo(screenX, this.y - 25);
                ctx.stroke();
                
                // ê½ƒì
                const colors = ['#FF6B6B', '#FFE66D', '#4ECDC4', '#FF69B4'];
                ctx.fillStyle = colors[Math.floor(this.x / 100) % colors.length];
                for (let i = 0; i < 5; i++) {
                    ctx.beginPath();
                    const angle = (i / 5) * Math.PI * 2;
                    ctx.ellipse(
                        screenX + Math.cos(angle) * 8,
                        this.y - 30 + Math.sin(angle) * 8,
                        6, 6, 0, 0, Math.PI * 2
                    );
                    ctx.fill();
                }
                ctx.fillStyle = '#FFD93D';
                ctx.beginPath();
                ctx.arc(screenX, this.y - 30, 5, 0, Math.PI * 2);
                ctx.fill();
            }

            drawBush(ctx, screenX) {
                ctx.fillStyle = '#2E8B57';
                ctx.beginPath();
                ctx.arc(screenX, this.y - 15, 25, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(screenX - 18, this.y - 10, 18, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(screenX + 18, this.y - 10, 18, 0, Math.PI * 2);
                ctx.fill();
            }

            drawCloud(ctx, screenX) {
                ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
                ctx.beginPath();
                ctx.arc(screenX, this.y, 30, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(screenX - 25, this.y + 5, 25, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(screenX + 25, this.y + 5, 25, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(screenX + 10, this.y - 15, 20, 0, Math.PI * 2);
                ctx.fill();
            }

            drawBuilding(ctx, screenX) {
                // ê±´ë¬¼
                const height = 60 + (this.x % 100);
                ctx.fillStyle = '#778899';
                ctx.fillRect(screenX - 25, this.y - height, 50, height);
                
                // ì°½ë¬¸
                ctx.fillStyle = '#FFE4B5';
                for (let row = 0; row < Math.floor(height / 20); row++) {
                    for (let col = 0; col < 2; col++) {
                        ctx.fillRect(
                            screenX - 18 + col * 22,
                            this.y - height + 10 + row * 20,
                            12, 10
                        );
                    }
                }
            }
        }

        // ê²Œì„ ì´ˆê¸°í™”
        function initGame() {
            canvas = document.getElementById('game-canvas');
            ctx = canvas.getContext('2d');
            
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
            
            setupControls();
        }

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            canvasWidth = canvas.width;
            canvasHeight = canvas.height;
        }

        function setupControls() {
            // í„°ì¹˜ ì»¨íŠ¸ë¡¤
            const btnLeft = document.getElementById('btn-left');
            const btnRight = document.getElementById('btn-right');
            const btnJump = document.getElementById('btn-jump');

            // í„°ì¹˜ ì´ë²¤íŠ¸
            btnLeft.addEventListener('touchstart', (e) => { e.preventDefault(); controls.left = true; });
            btnLeft.addEventListener('touchend', (e) => { e.preventDefault(); controls.left = false; });
            btnRight.addEventListener('touchstart', (e) => { e.preventDefault(); controls.right = true; });
            btnRight.addEventListener('touchend', (e) => { e.preventDefault(); controls.right = false; });
            btnJump.addEventListener('touchstart', (e) => { e.preventDefault(); controls.jump = true; });
            btnJump.addEventListener('touchend', (e) => { e.preventDefault(); controls.jump = false; });

            // ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸ (í…ŒìŠ¤íŠ¸ìš©)
            btnLeft.addEventListener('mousedown', () => controls.left = true);
            btnLeft.addEventListener('mouseup', () => controls.left = false);
            btnLeft.addEventListener('mouseleave', () => controls.left = false);
            btnRight.addEventListener('mousedown', () => controls.right = true);
            btnRight.addEventListener('mouseup', () => controls.right = false);
            btnRight.addEventListener('mouseleave', () => controls.right = false);
            btnJump.addEventListener('mousedown', () => controls.jump = true);
            btnJump.addEventListener('mouseup', () => controls.jump = false);
            btnJump.addEventListener('mouseleave', () => controls.jump = false);

            // í‚¤ë³´ë“œ ì»¨íŠ¸ë¡¤
            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowLeft' || e.key === 'a') controls.left = true;
                if (e.key === 'ArrowRight' || e.key === 'd') controls.right = true;
                if (e.key === 'ArrowUp' || e.key === 'w' || e.key === ' ') controls.jump = true;
                if (e.key === 'Escape') togglePause();
            });
            document.addEventListener('keyup', (e) => {
                if (e.key === 'ArrowLeft' || e.key === 'a') controls.left = false;
                if (e.key === 'ArrowRight' || e.key === 'd') controls.right = false;
                if (e.key === 'ArrowUp' || e.key === 'w' || e.key === ' ') controls.jump = false;
            });
        }

        function createLevel() {
            const groundY = canvasHeight - 80;
            
            // í”Œë ˆì´ì–´ ìƒì„±
            player = new Player(100, groundY - 100);

            // í”Œë«í¼ ìƒì„± (ê¸´ êµ¬ê°„ ê±°ë¦¬ ì¡°ì •)
            platforms = [
                new Platform(350, groundY - 100, 150),
                new Platform(650, groundY - 180, 150),
                new Platform(980, groundY - 120, 200),
                new Platform(1350, groundY - 200, 150),
                new Platform(1700, groundY - 150, 180),
                new Platform(2040, groundY - 220, 150),
                new Platform(2390, groundY - 140, 200),
                new Platform(2770, groundY - 180, 150),
                new Platform(3120, groundY - 250, 180),
                new Platform(3470, groundY - 160, 200),
                new Platform(3820, groundY - 200, 150),
                new Platform(4170, groundY - 140, 200),
            ];

            // ë¯¸ì…˜ í•­ì•„ë¦¬ ìƒì„± (7ê°œ) - í”Œë«í¼ ìœ„ì¹˜ì— ë§ê²Œ ì¡°ì •
            jars = [
                new Jar(400, groundY - 160, 0),      // íšŒì‚¬ì›
                new Jar(700, groundY - 240, 1),      // ì„¸ë¬´ì‚¬
                new Jar(1080, groundY - 180, 2),     // ìœ íŠœë²„
                new Jar(1750, groundY - 210, 3),     // ê³µì¸íšŒê³„ì‚¬
                new Jar(2440, groundY - 200, 4),     // ì¹´í˜ ì‚¬ì¥
                new Jar(3170, groundY - 310, 5),     // êµ­ì„¸ì²­ ê³µë¬´ì›
                new Jar(4220, groundY - 200, 6),     // ì€í‡´ì
            ];

            // ì¥ì‹ ìš”ì†Œ ìƒì„±
            decorations = [];
            
            // êµ¬ë¦„
            for (let i = 0; i < 15; i++) {
                decorations.push(new Decoration(
                    200 + i * 300 + Math.random() * 100,
                    50 + Math.random() * 80,
                    'cloud'
                ));
            }

            // ë‚˜ë¬´ì™€ ë¤ë¶ˆ
            for (let i = 0; i < 20; i++) {
                const x = 150 + i * 200 + Math.random() * 50;
                if (Math.random() > 0.5) {
                    decorations.push(new Decoration(x, groundY, 'tree'));
                } else {
                    decorations.push(new Decoration(x, groundY, 'bush'));
                }
            }

            // ê½ƒ
            for (let i = 0; i < 30; i++) {
                decorations.push(new Decoration(
                    50 + i * 130 + Math.random() * 50,
                    groundY,
                    'flower'
                ));
            }

            // ë°°ê²½ ê±´ë¬¼
            for (let i = 0; i < 8; i++) {
                decorations.push(new Decoration(
                    500 + i * 500,
                    groundY,
                    'building'
                ));
            }
        }

        function startGame() {
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.add('active');
            
            gameState.isPlaying = true;
            gameState.isPaused = false;
            gameState.completedJars = 0;
            gameState.collectedJobs = [];
            
            createLevel();
            updateHUD();
            gameLoop();
        }

        function restartGame() {
            // ê²Œì„ ë£¨í”„ ì¤‘ì§€
            if (gameLoopId) {
                cancelAnimationFrame(gameLoopId);
                gameLoopId = null;
            }
            
            // í™”ë©´ ì „í™˜
            document.getElementById('clear-screen').classList.remove('active');
            document.getElementById('game-screen').classList.add('active');
            
            // ê²Œì„ ìƒíƒœ ì´ˆê¸°í™”
            gameState.isPlaying = true;
            gameState.isPaused = false;
            gameState.completedJars = 0;
            gameState.collectedJobs = [];
            gameState.currentQuiz = null;
            cameraX = 0;
            
            // ì»¨íŠ¸ë¡¤ ì´ˆê¸°í™”
            controls.left = false;
            controls.right = false;
            controls.jump = false;
            
            // ë ˆë²¨ ì¬ìƒì„±
            createLevel();
            updateHUD();
            
            // ê²Œì„ ë£¨í”„ ì‹œì‘
            gameLoop();
        }

        function restartFromPause() {
            togglePause();
            
            // ê²Œì„ ë£¨í”„ ì¤‘ì§€
            if (gameLoopId) {
                cancelAnimationFrame(gameLoopId);
                gameLoopId = null;
            }
            
            // ê²Œì„ ìƒíƒœ ì´ˆê¸°í™”
            gameState.isPlaying = true;
            gameState.isPaused = false;
            gameState.completedJars = 0;
            gameState.collectedJobs = [];
            gameState.currentQuiz = null;
            cameraX = 0;
            
            // ì»¨íŠ¸ë¡¤ ì´ˆê¸°í™”
            controls.left = false;
            controls.right = false;
            controls.jump = false;
            
            // ë ˆë²¨ ì¬ìƒì„±
            createLevel();
            updateHUD();
            
            // ê²Œì„ ë£¨í”„ ì‹œì‘
            gameLoop();
        }

        function togglePause() {
            if (!gameState.isPlaying && !gameState.isPaused) return;
            
            gameState.isPaused = !gameState.isPaused;
            document.getElementById('pause-modal').classList.toggle('active');
            
            if (!gameState.isPaused && gameState.isPlaying) {
                gameLoop();
            }
        }

        function endGame() {
            window.close();
            // ì°½ì´ ë‹«íˆì§€ ì•ŠëŠ” ê²½ìš° (ë¸Œë¼ìš°ì € ì •ì±…ìœ¼ë¡œ ì¸í•´)
            // ë¹ˆ í˜ì´ì§€ë¡œ ì´ë™í•˜ê±°ë‚˜ ì•Œë¦¼ í‘œì‹œ
            setTimeout(() => {
                document.body.innerHTML = '<div style="display:flex;align-items:center;justify-content:center;height:100vh;font-family:Noto Sans KR,sans-serif;font-size:1.5rem;color:#4A3728;text-align:center;padding:20px;background:linear-gradient(180deg, #FFE66D 0%, #FFB347 100%);">ê²Œì„ì´ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.<br>ì´ íƒ­ì„ ë‹«ì•„ì£¼ì„¸ìš”.</div>';
            }, 100);
        }

        function gameLoop() {
            if (!gameState.isPlaying || gameState.isPaused) return;

            update();
            draw();
            
            gameLoopId = requestAnimationFrame(gameLoop);
        }

        function update() {
            player.update();
            
            // ì¹´ë©”ë¼ ë”°ë¼ê°€ê¸°
            const targetCameraX = player.x - canvasWidth / 3;
            cameraX = Math.max(0, Math.min(targetCameraX, WORLD_WIDTH - canvasWidth));
            
            // í•­ì•„ë¦¬ ì—…ë°ì´íŠ¸ ë° ì¶©ëŒ ì²´í¬
            for (let jar of jars) {
                jar.update();
                if (jar.checkCollision(player)) {
                    showQuiz(jar);
                }
            }
        }

        function draw() {
            // ë°°ê²½
            const gradient = ctx.createLinearGradient(0, 0, 0, canvasHeight);
            gradient.addColorStop(0, '#87CEEB');
            gradient.addColorStop(0.6, '#E0F6FF');
            gradient.addColorStop(1, '#98D8AA');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvasWidth, canvasHeight);

            // ë°°ê²½ ì¥ì‹ (ê±´ë¬¼, êµ¬ë¦„)
            decorations.filter(d => d.type === 'cloud' || d.type === 'building')
                       .forEach(d => d.draw(ctx));

            // ë°”ë‹¥
            const groundY = canvasHeight - 80;
            ctx.fillStyle = '#228B22';
            ctx.fillRect(0, groundY, canvasWidth, 20);
            ctx.fillStyle = '#8B4513';
            ctx.fillRect(0, groundY + 20, canvasWidth, 60);
            
            // ì”ë”” íŒ¨í„´
            ctx.fillStyle = '#32CD32';
            for (let i = 0; i < canvasWidth; i += 20) {
                ctx.beginPath();
                ctx.moveTo(i, groundY);
                ctx.lineTo(i + 5, groundY - 8);
                ctx.lineTo(i + 10, groundY);
                ctx.fill();
            }

            // ì „ê²½ ì¥ì‹ (ë‚˜ë¬´, ë¤ë¶ˆ, ê½ƒ)
            decorations.filter(d => d.type !== 'cloud' && d.type !== 'building')
                       .forEach(d => d.draw(ctx));

            // í”Œë«í¼
            platforms.forEach(p => p.draw(ctx));

            // ë¯¸ì…˜ í•­ì•„ë¦¬
            jars.forEach(j => j.draw(ctx));

            // í”Œë ˆì´ì–´
            player.draw(ctx);

            // ì§„í–‰ í‘œì‹œ í™”ì‚´í‘œ (ìš°ì¸¡ìœ¼ë¡œ ê°€ì•¼ í•¨ì„ í‘œì‹œ)
            if (player.x < 200) {
                ctx.fillStyle = 'rgba(255, 215, 0, 0.8)';
                ctx.font = 'bold 30px sans-serif';
                ctx.fillText('â†’ ì´ë™í•˜ì—¬ ë¯¸ì…˜ í•­ì•„ë¦¬ë¥¼ ì°¾ìœ¼ì„¸ìš”!', canvasWidth / 2 - 200, 100);
            }
        }

        function showQuiz(jar) {
            gameState.isPlaying = false;
            gameState.currentQuiz = jar;
            
            const quiz = jobQuizzes[jar.quizIndex];
            
            document.getElementById('quiz-job-name').textContent = `ğŸ’¼ ${quiz.job} (${quiz.incomeType})`;
            document.getElementById('quiz-question').textContent = quiz.question;
            document.getElementById('quiz-result').className = 'quiz-result';
            document.getElementById('quiz-result').innerHTML = '';
            document.getElementById('quiz-buttons').style.display = 'flex';
            
            document.getElementById('quiz-modal').classList.add('active');
        }

        function answerQuiz(answer) {
            const jar = gameState.currentQuiz;
            const quiz = jobQuizzes[jar.quizIndex];
            const resultDiv = document.getElementById('quiz-result');
            const buttonsDiv = document.getElementById('quiz-buttons');
            
            if (answer === quiz.answer) {
                // ì •ë‹µ
                resultDiv.className = 'quiz-result correct';
                resultDiv.innerHTML = `
                    <p>ğŸ‰ ì •ë‹µì…ë‹ˆë‹¤!</p>
                    <p style="margin-top: 10px; font-weight: normal;">${quiz.explanation}</p>
                    <button class="retry-btn" onclick="closeQuiz(true)" style="background: #4CAF50; box-shadow: 0 4px 0 #388E3C;">
                        ê³„ì†í•˜ê¸°
                    </button>
                `;
                buttonsDiv.style.display = 'none';
            } else {
                // ì˜¤ë‹µ
                resultDiv.className = 'quiz-result wrong';
                resultDiv.innerHTML = `
                    <p>âŒ í‹€ë ¸ìŠµë‹ˆë‹¤!</p>
                    <p style="margin-top: 10px; font-weight: normal;">ë‹¤ì‹œ í•œë²ˆ ìƒê°í•´ë³´ì„¸ìš”.</p>
                    <button class="retry-btn" onclick="retryQuiz()">
                        ë‹¤ì‹œ í’€ê¸°
                    </button>
                `;
                buttonsDiv.style.display = 'none';
            }
        }

        function retryQuiz() {
            document.getElementById('quiz-result').className = 'quiz-result';
            document.getElementById('quiz-result').innerHTML = '';
            document.getElementById('quiz-buttons').style.display = 'flex';
        }

        function closeQuiz(success) {
            document.getElementById('quiz-modal').classList.remove('active');
            
            if (success) {
                const jar = gameState.currentQuiz;
                const quiz = jobQuizzes[jar.quizIndex];
                
                jar.completed = true;
                gameState.completedJars++;
                gameState.collectedJobs.push(quiz.job);
                
                updateHUD();
                
                // ëª¨ë“  í•­ì•„ë¦¬ ì™„ë£Œ ì²´í¬
                if (gameState.completedJars >= 7) {
                    setTimeout(showClearScreen, 500);
                    return;
                }
            }
            
            gameState.isPlaying = true;
            gameState.currentQuiz = null;
            gameLoop();
        }

        function updateHUD() {
            document.getElementById('jar-count').textContent = `${gameState.completedJars} / 7`;
            document.getElementById('job-count').textContent = `ìˆ˜ì§‘í•œ ì§ì—…: ${gameState.collectedJobs.length}`;
        }

        function showClearScreen() {
            document.getElementById('game-screen').classList.remove('active');
            document.getElementById('clear-screen').classList.add('active');
            
            document.getElementById('collected-count').textContent = 
                `ğŸ’¼ ìˆ˜ì§‘í•œ ì§ì—…: ${gameState.collectedJobs.length}ê°œ`;
            
            const jobsList = document.getElementById('collected-jobs-list');
            jobsList.innerHTML = gameState.collectedJobs
                .map(job => `<div class="job-card-mini">${job}</div>`)
                .join('');
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.addEventListener('load', initGame);
    </script>
</body>
</html>
