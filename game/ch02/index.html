<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ÎßàÏùÑ ÏßÄÌÇ§Í∏∞ - Î≤ΩÎèåÍπ®Í∏∞</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            overflow: hidden;
            touch-action: none;
            user-select: none;
        }
        
        #game-container {
            width: 100vw;
            height: 100vh;
            position: relative;
            overflow: hidden;
        }
        
        /* ÏãúÏûë ÌôîÎ©¥ */
        #start-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg, #87CEEB 0%, #E0F6FF 50%, #90EE90 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding: 20px 10px;
            padding-top: max(20px, env(safe-area-inset-top));
            padding-bottom: max(20px, env(safe-area-inset-bottom));
            z-index: 100;
            transition: opacity 0.5s, visibility 0.5s;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        @media (min-height: 600px) {
            #start-screen {
                justify-content: center;
                padding-top: 20px;
            }
        }
        
        #start-screen.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }
        
        .game-title {
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 700;
            font-size: clamp(2.2rem, 7vw, 4rem);
            color: #2E5A1C;
            text-shadow: 3px 3px 0 #90EE90, 5px 5px 0 rgba(0,0,0,0.2);
            margin-bottom: 5px;
            text-align: center;
        }
        
        .game-subtitle {
            font-size: clamp(0.95rem, 2.8vw, 1.4rem);
            color: #3D7A2A;
            font-weight: 700;
            margin-bottom: 15px;
        }
        
        /* ÏÑ∏Ïã¨Ïù¥ Ï∫êÎ¶≠ÌÑ∞ */
        .sesim-character {
            width: 100px;
            height: 120px;
            position: relative;
            margin: 15px auto;
            animation: float 2s ease-in-out infinite;
        }
        
        .sesim-character.small {
            width: 70px;
            height: 85px;
            margin: 10px auto;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }
        
        .sesim-body {
            width: 85px;
            height: 85px;
            background: linear-gradient(180deg, #4A3728 0%, #4A3728 45%, #FFD93D 45%, #FFD93D 100%);
            border-radius: 50%;
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            border: 3px solid #3D2E1F;
        }
        
        .sesim-character.small .sesim-body {
            width: 60px;
            height: 60px;
        }
        
        .sesim-face {
            width: 60px;
            height: 42px;
            background: #FFE4B5;
            border-radius: 50%;
            position: absolute;
            top: 12px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .sesim-character.small .sesim-face {
            width: 42px;
            height: 30px;
            top: 8px;
        }
        
        .sesim-eye {
            width: 7px;
            height: 9px;
            background: #2D2D2D;
            border-radius: 50%;
            position: absolute;
            top: 15px;
        }
        
        .sesim-eye.left { left: 15px; }
        .sesim-eye.right { right: 15px; }
        
        .sesim-character.small .sesim-eye {
            width: 5px;
            height: 6px;
            top: 10px;
        }
        
        .sesim-character.small .sesim-eye.left { left: 10px; }
        .sesim-character.small .sesim-eye.right { right: 10px; }
        
        .sesim-mouth {
            width: 12px;
            height: 8px;
            background: #E85A4F;
            border-radius: 0 0 10px 10px;
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .sesim-character.small .sesim-mouth {
            width: 8px;
            height: 5px;
            bottom: 7px;
        }
        
        .sesim-cheek {
            width: 10px;
            height: 6px;
            background: #FFB6C1;
            border-radius: 50%;
            position: absolute;
            top: 24px;
            opacity: 0.7;
        }
        
        .sesim-cheek.left { left: 6px; }
        .sesim-cheek.right { right: 6px; }
        
        .sesim-character.small .sesim-cheek {
            width: 7px;
            height: 4px;
            top: 17px;
        }
        
        .sesim-character.small .sesim-cheek.left { left: 4px; }
        .sesim-character.small .sesim-cheek.right { right: 4px; }
        
        .sesim-antenna {
            width: 3px;
            height: 25px;
            background: #4A3728;
            position: absolute;
            top: -20px;
            border-radius: 2px;
        }
        
        .sesim-antenna.left { left: 30px; transform: rotate(-15deg); }
        .sesim-antenna.right { right: 30px; transform: rotate(15deg); }
        
        .sesim-character.small .sesim-antenna {
            width: 2px;
            height: 18px;
            top: -15px;
        }
        
        .sesim-character.small .sesim-antenna.left { left: 20px; }
        .sesim-character.small .sesim-antenna.right { right: 20px; }
        
        .sesim-antenna-ball {
            width: 12px;
            height: 12px;
            background: #FFD93D;
            border-radius: 50%;
            position: absolute;
            top: -7px;
            left: -4.5px;
            border: 2px solid #4A3728;
        }
        
        .sesim-character.small .sesim-antenna-ball {
            width: 8px;
            height: 8px;
            top: -5px;
            left: -3px;
        }
        
        .sesim-wing {
            width: 30px;
            height: 38px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            position: absolute;
            top: 25px;
            border: 2px solid rgba(150, 150, 150, 0.3);
            animation: wingFlap 0.15s ease-in-out infinite alternate;
        }
        
        .sesim-wing.left { left: -17px; transform: rotate(-20deg); }
        .sesim-wing.right { right: -17px; transform: rotate(20deg); animation-delay: 0.075s; }
        
        .sesim-character.small .sesim-wing {
            width: 20px;
            height: 26px;
            top: 18px;
        }
        
        .sesim-character.small .sesim-wing.left { left: -12px; }
        .sesim-character.small .sesim-wing.right { right: -12px; }
        
        @keyframes wingFlap {
            0% { transform: rotate(-20deg) scaleY(1); }
            100% { transform: rotate(-30deg) scaleY(0.9); }
        }
        
        .sesim-badge {
            width: 22px;
            height: 15px;
            background: #FFF;
            border: 1px solid #CCC;
            position: absolute;
            bottom: 17px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 2px;
            font-size: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
        }
        
        .sesim-character.small .sesim-badge {
            width: 16px;
            height: 11px;
            bottom: 12px;
            font-size: 4px;
        }
        
        .start-btn {
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 700;
            font-size: clamp(1.3rem, 3.5vw, 1.8rem);
            padding: 12px 50px;
            background: linear-gradient(180deg, #4CAF50 0%, #388E3C 100%);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 5px 0 #2E7D32, 0 7px 15px rgba(0,0,0,0.3);
            transition: all 0.1s;
            margin-top: 15px;
        }
        
        .start-btn:active {
            transform: translateY(3px);
            box-shadow: 0 2px 0 #2E7D32, 0 3px 8px rgba(0,0,0,0.3);
        }
        
        .instructions {
            margin-top: 20px;
            text-align: center;
            color: #2E5A1C;
            font-size: clamp(0.8rem, 2.2vw, 1rem);
            line-height: 1.7;
            background: rgba(255,255,255,0.7);
            padding: 12px 20px;
            border-radius: 12px;
            max-width: 90%;
        }
        
        .instructions strong {
            color: #1B5E20;
        }
        
        /* Í≤åÏûÑ ÌôîÎ©¥ */
        #game-screen {
            width: 100%;
            height: 100%;
            display: none;
            position: relative;
            background: linear-gradient(180deg, #1a1a2e 0%, #16213e 100%);
        }
        
        #game-screen.active {
            display: block;
        }
        
        #game-canvas {
            width: 100%;
            height: 100%;
            display: block;
        }
        
        /* HUD */
        #hud {
            position: absolute;
            top: 8px;
            left: 8px;
            right: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            z-index: 10;
        }
        
        .hud-item {
            display: flex;
            align-items: center;
            gap: 4px;
            font-weight: 700;
            color: #333;
            font-size: clamp(0.7rem, 2vw, 0.9rem);
        }
        
        .hud-icon {
            font-size: clamp(0.9rem, 2.2vw, 1.1rem);
        }
        
        .pause-btn {
            background: linear-gradient(180deg, #FF9800 0%, #F57C00 100%);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 6px 12px;
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 700;
            font-size: clamp(0.7rem, 2vw, 0.85rem);
            cursor: pointer;
            box-shadow: 0 2px 0 #E65100;
            transition: all 0.1s;
        }
        
        .pause-btn:active {
            transform: translateY(2px);
            box-shadow: 0 0 0 #E65100;
        }
        
        /* OX ÌÄ¥Ï¶à Î™®Îã¨ */
        #quiz-modal {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 50;
        }
        
        #quiz-modal.active {
            display: flex;
        }
        
        .quiz-box {
            background: linear-gradient(180deg, #FFF9E6 0%, #FFF 100%);
            border-radius: 20px;
            padding: 20px;
            max-width: 92%;
            width: 500px;
            text-align: center;
            box-shadow: 0 8px 30px rgba(0,0,0,0.4);
            border: 4px solid #FFD700;
            animation: popIn 0.3s ease-out;
        }
        
        @keyframes popIn {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .quiz-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 12px;
        }
        
        .quiz-facility {
            font-size: clamp(2rem, 6vw, 2.8rem);
        }
        
        .quiz-title {
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 700;
            font-size: clamp(1.1rem, 3.5vw, 1.5rem);
            color: #4A3728;
        }
        
        .quiz-question {
            font-size: clamp(0.95rem, 2.8vw, 1.2rem);
            color: #333;
            line-height: 1.6;
            margin-bottom: 18px;
            padding: 12px;
            background: #FFF;
            border-radius: 12px;
            border: 2px solid #EEE;
        }
        
        .quiz-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        
        .quiz-btn {
            width: clamp(65px, 16vw, 90px);
            height: clamp(65px, 16vw, 90px);
            border-radius: 50%;
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 700;
            font-size: clamp(1.6rem, 5vw, 2.2rem);
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 0 rgba(0,0,0,0.2);
        }
        
        .quiz-btn.o-btn {
            background: linear-gradient(180deg, #4CAF50 0%, #388E3C 100%);
            color: white;
        }
        
        .quiz-btn.x-btn {
            background: linear-gradient(180deg, #F44336 0%, #D32F2F 100%);
            color: white;
        }
        
        .quiz-btn:active {
            transform: translateY(3px);
            box-shadow: 0 1px 0 rgba(0,0,0,0.2);
        }
        
        .quiz-result {
            display: none;
            padding: 12px;
            border-radius: 10px;
            margin-top: 12px;
            font-size: clamp(0.85rem, 2.3vw, 1rem);
            font-weight: 700;
        }
        
        .quiz-result.correct {
            display: block;
            background: #E8F5E9;
            color: #2E7D32;
            border: 2px solid #4CAF50;
        }
        
        .quiz-result.wrong {
            display: block;
            background: #FFEBEE;
            color: #C62828;
            border: 2px solid #F44336;
        }
        
        .result-btn {
            margin-top: 10px;
            padding: 10px 22px;
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 700;
            font-size: clamp(0.85rem, 2.3vw, 1rem);
            color: white;
            border: none;
            border-radius: 18px;
            cursor: pointer;
        }
        
        .result-btn.retry {
            background: #FF9800;
            box-shadow: 0 3px 0 #F57C00;
        }
        
        .result-btn.continue {
            background: #4CAF50;
            box-shadow: 0 3px 0 #388E3C;
        }
        
        .result-btn:active {
            transform: translateY(2px);
            box-shadow: 0 1px 0 rgba(0,0,0,0.3);
        }
        
        /* Í≤∞Í≥º ÌôîÎ©¥ */
        #result-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding: 20px 10px;
            padding-top: max(20px, env(safe-area-inset-top));
            padding-bottom: max(20px, env(safe-area-inset-bottom));
            z-index: 100;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        @media (min-height: 550px) {
            #result-screen {
                justify-content: center;
                padding-top: 20px;
            }
        }
        
        #result-screen.active {
            display: flex;
        }
        
        #result-screen.win {
            background: linear-gradient(180deg, #FFE66D 0%, #FFB347 100%);
        }
        
        #result-screen.lose {
            background: linear-gradient(180deg, #546E7A 0%, #37474F 100%);
        }
        
        .result-title {
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 700;
            font-size: clamp(2rem, 6.5vw, 3.2rem);
            margin-bottom: 10px;
            animation: bounce 0.6s ease-in-out infinite;
        }
        
        #result-screen.win .result-title {
            color: #4A3728;
            text-shadow: 3px 3px 0 #FFE66D;
        }
        
        #result-screen.lose .result-title {
            color: #FFF;
            text-shadow: 3px 3px 0 #263238;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }
        
        .result-stats {
            background: rgba(255,255,255,0.92);
            padding: 18px 30px;
            border-radius: 16px;
            margin: 12px 0;
            text-align: center;
        }
        
        .stat-row {
            font-size: clamp(0.95rem, 2.7vw, 1.2rem);
            color: #4A3728;
            margin: 6px 0;
            font-weight: 700;
        }
        
        .achievement-badge {
            background: linear-gradient(180deg, #FFD700 0%, #FFA500 100%);
            color: #4A3728;
            padding: 10px 22px;
            border-radius: 22px;
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 700;
            font-size: clamp(1rem, 2.8vw, 1.3rem);
            margin-top: 12px;
            box-shadow: 0 3px 12px rgba(0,0,0,0.2);
        }
        
        .exit-btn {
            background: linear-gradient(180deg, #78909C 0%, #546E7A 100%);
            box-shadow: 0 5px 0 #37474F, 0 7px 15px rgba(0,0,0,0.3);
            margin-top: 10px;
        }
        
        .exit-btn:active {
            box-shadow: 0 2px 0 #37474F, 0 3px 8px rgba(0,0,0,0.3);
        }
        
        /* ÏùºÏãúÏ†ïÏßÄ ÏïàÎÇ¥ */
        #pause-indicator {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 700;
            font-size: clamp(1.5rem, 4vw, 2rem);
            color: #FFD700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            display: none;
            z-index: 20;
        }
        
        #pause-indicator.show {
            display: block;
            animation: pulse 1s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        /* ÏùºÏãúÏ†ïÏßÄ Ïò§Î≤ÑÎ†àÏù¥ */
        #pause-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: transparent;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 25;
        }
        
        #pause-overlay.active {
            display: flex;
        }
        
        .pause-text {
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 700;
            font-size: clamp(1.8rem, 5vw, 2.5rem);
            color: #FFD700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            margin-bottom: 20px;
        }
        
        .pause-overlay-btn {
            font-family: 'Noto Sans KR', sans-serif;
            font-weight: 700;
            font-size: clamp(1rem, 2.5vw, 1.2rem);
            padding: 12px 40px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.1s;
            color: white;
            margin-bottom: 10px;
        }
        
        .pause-overlay-btn.resume {
            background: linear-gradient(180deg, #4CAF50 0%, #388E3C 100%);
            box-shadow: 0 4px 0 #2E7D32;
        }
        
        .pause-overlay-btn.restart {
            background: linear-gradient(180deg, #FF9800 0%, #F57C00 100%);
            box-shadow: 0 4px 0 #E65100;
        }
        
        .pause-overlay-btn:active {
            transform: translateY(3px);
            box-shadow: 0 1px 0 rgba(0,0,0,0.3);
        }
    </style>
</head>
<body>
    <div id="game-container">
        <!-- ÏãúÏûë ÌôîÎ©¥ -->
        <div id="start-screen">
            <h1 class="game-title">üèòÔ∏è ÎßàÏùÑ ÏßÄÌÇ§Í∏∞</h1>
            <p class="game-subtitle">Î≤ΩÎèåÍπ®Í∏∞Î°ú Î∞∞Ïö∞Îäî ÏÑ∏Í∏àÍ≥º Í≥µÍ≥µÏÑúÎπÑÏä§</p>
            
            <div class="sesim-character">
                <div class="sesim-body">
                    <div class="sesim-antenna left"><div class="sesim-antenna-ball"></div></div>
                    <div class="sesim-antenna right"><div class="sesim-antenna-ball"></div></div>
                    <div class="sesim-wing left"></div>
                    <div class="sesim-wing right"></div>
                    <div class="sesim-face">
                        <div class="sesim-eye left"></div>
                        <div class="sesim-eye right"></div>
                        <div class="sesim-cheek left"></div>
                        <div class="sesim-cheek right"></div>
                        <div class="sesim-mouth"></div>
                    </div>
                    <div class="sesim-badge">ÏÑ∏Ïã¨</div>
                </div>
            </div>
            
            <button class="start-btn" onclick="startGame()">Í≤åÏûÑ ÏãúÏûë!</button>
            
            <div class="instructions">
                üéÆ <strong>Í≤åÏûÑ Î∞©Î≤ï</strong><br>
                Ìå®Îì§ÏùÑ ÏõÄÏßÅÏó¨ Í≥µÏùÑ ÌäïÍ≤® Î≤ΩÎèåÏùÑ Íπ®ÏÑ∏Ïöî!<br><br>
                ‚≠ê <strong>Í∏àÏÉâ Î≤ΩÎèå</strong>(Í≥µÍ≥µÏÑúÎπÑÏä§)Ïóê ÎãøÏúºÎ©¥ ÌÄ¥Ï¶à!<br>
                Ï†ïÎãµÏùÑ ÎßûÌûàÎ©¥ Ï£ºÎ≥Ä Î≤ΩÎèåÏù¥ Ìï®Íªò ÌååÍ¥¥ÎèºÏöî!<br><br>
                üéØ Î™®Îì† Î≤ΩÎèåÏùÑ Íπ®Í≥† 6Í∞ú ÌÄ¥Ï¶àÎ•º ÌÜµÍ≥ºÌïòÎ©¥ ÏäπÎ¶¨!
            </div>
        </div>
        
        <!-- Í≤åÏûÑ ÌôîÎ©¥ -->
        <div id="game-screen">
            <canvas id="game-canvas"></canvas>
            
            <div id="hud">
                <div class="hud-item">
                    <span class="hud-icon">‚ù§Ô∏è</span>
                    <span id="lives-display">3</span>
                </div>
                <div class="hud-item">
                    <span class="hud-icon">üß±</span>
                    <span id="bricks-display">0</span>
                </div>
                <div class="hud-item">
                    <span class="hud-icon">‚úÖ</span>
                    <span id="quiz-display">0/6</span>
                </div>
                <div class="hud-item">
                    <span class="hud-icon">‚ö°</span>
                    <span id="speed-display">1x</span>
                </div>
                <button class="pause-btn" id="pause-btn" onclick="togglePause()">ÏùºÏãúÏ†ïÏßÄ</button>
            </div>
            
            <div id="pause-indicator">ÌÄ¥Ï¶à ÌÉÄÏûÑ!</div>
            
            <!-- ÏùºÏãúÏ†ïÏßÄ Ïò§Î≤ÑÎ†àÏù¥ -->
            <div id="pause-overlay">
                <div class="pause-text">‚è∏Ô∏è ÏùºÏãúÏ†ïÏßÄ</div>
                <button class="pause-overlay-btn resume" onclick="togglePause()">Í≥ÑÏÜçÌïòÍ∏∞</button>
                <button class="pause-overlay-btn restart" onclick="restartFromPause()">Ï≤òÏùåÎ∂ÄÌÑ∞</button>
            </div>
        </div>
        
        <!-- OX ÌÄ¥Ï¶à Î™®Îã¨ -->
        <div id="quiz-modal">
            <div class="quiz-box">
                <div class="quiz-header">
                    <span class="quiz-facility" id="quiz-facility">üöí</span>
                    <h2 class="quiz-title" id="quiz-title">ÏÜåÎ∞©ÏÑú ÌÄ¥Ï¶à!</h2>
                </div>
                <p class="quiz-question" id="quiz-question">
                    ÏÜåÎ∞©ÏÑúÎäî ÏÑ∏Í∏àÏúºÎ°ú Ïö¥ÏòÅÎêúÎã§.
                </p>
                <div class="quiz-buttons" id="quiz-buttons">
                    <button class="quiz-btn o-btn" onclick="answerQuiz(true)">O</button>
                    <button class="quiz-btn x-btn" onclick="answerQuiz(false)">X</button>
                </div>
                <div class="quiz-result" id="quiz-result"></div>
            </div>
        </div>
        
        <!-- Í≤∞Í≥º ÌôîÎ©¥ -->
        <div id="result-screen">
            <h1 class="result-title" id="result-title">üéâ Í≤åÏûÑ ÌÅ¥Î¶¨Ïñ¥!</h1>
            
            <div class="sesim-character small">
                <div class="sesim-body">
                    <div class="sesim-antenna left"><div class="sesim-antenna-ball"></div></div>
                    <div class="sesim-antenna right"><div class="sesim-antenna-ball"></div></div>
                    <div class="sesim-wing left"></div>
                    <div class="sesim-wing right"></div>
                    <div class="sesim-face">
                        <div class="sesim-eye left"></div>
                        <div class="sesim-eye right"></div>
                        <div class="sesim-cheek left"></div>
                        <div class="sesim-cheek right"></div>
                        <div class="sesim-mouth"></div>
                    </div>
                    <div class="sesim-badge">ÏÑ∏Ïã¨</div>
                </div>
            </div>
            
            <div class="result-stats">
                <div class="stat-row">‚úÖ ÌÜµÍ≥ºÌïú ÌÄ¥Ï¶à: <span id="final-quiz">6</span>/6</div>
                <div class="stat-row">üß± Íπ¨ Î≤ΩÎèå: <span id="final-bricks">0</span>Í∞ú</div>
                <div class="stat-row">‚ù§Ô∏è ÎÇ®ÏùÄ ÏÉùÎ™Ö: <span id="final-lives">3</span>Í∞ú</div>
            </div>
            
            <div class="achievement-badge" id="achievement-badge">üèÜ ÎßàÏùÑÏùò ÏòÅÏõÖ!</div>
            
            <button class="start-btn" onclick="restartGame()">Îã§Ïãú ÌïòÍ∏∞</button>
            <button class="start-btn exit-btn" onclick="exitGame()">Í≤åÏûÑ Ï¢ÖÎ£å</button>
        </div>
    </div>

    <script>
        // Í≤åÏûÑ ÏÑ§Ï†ï
        const CONFIG = {
            PADDLE_WIDTH: 100,
            PADDLE_HEIGHT: 15,
            BALL_RADIUS: 8,
            BALL_BASE_SPEED: 5,
            BRICK_ROWS: 6,
            BRICK_COLS: 8,
            BRICK_PADDING: 6,
            BRICK_TOP_OFFSET: 70,
            LIVES: 3,
            SPEED_INCREASE_INTERVAL: 30000, // 30Ï¥àÎßàÎã§ ÏÜçÎèÑ Ï¶ùÍ∞Ä
            SPEED_INCREASE_AMOUNT: 0.15
        };

        // Í≤åÏûÑ ÏÉÅÌÉú
        let gameState = {
            isPlaying: false,
            isPaused: false,
            lives: CONFIG.LIVES,
            bricksDestroyed: 0,
            totalBricks: 0,
            quizzesPassed: 0,
            totalQuizzes: 6,
            speedMultiplier: 1,
            currentQuizBrick: null,
            usedQuizIndices: []
        };

        // Ï∫îÎ≤ÑÏä§
        let canvas, ctx;
        let canvasWidth, canvasHeight;

        // Í≤åÏûÑ Ïò§Î∏åÏ†ùÌä∏
        let paddle, ball, bricks;
        let particles = [];

        // ÏãúÍ∞Ñ Ï∂îÏ†Å
        let gameStartTime;
        let lastSpeedIncreaseTime;

        // Î∂ÄÏ†ïÏ†Å ÏöîÏÜå Î≤ΩÎèå ÌÉÄÏûÖ
        const negativeBrickTypes = [
            { icon: 'üî•', name: 'ÌôîÏû¨', color: '#FF5722' },
            { icon: 'üöó', name: 'ÍµêÌÜµÏÇ¨Í≥†', color: '#607D8B' },
            { icon: 'üëä', name: 'Ìè≠Î†•', color: '#E53935' },
            { icon: 'ü¶†', name: 'ÏßàÎ≥ë', color: '#8BC34A' },
            { icon: 'üí∞', name: 'Ï†àÎèÑ', color: '#424242' },
            { icon: 'üî™', name: 'Í∞ïÎèÑ', color: '#B71C1C' },
            { icon: 'üìµ', name: 'Î¨¥Í¥ÄÏã¨', color: '#7B1FA2' }
        ];

        // Í≥µÍ≥µÏÑúÎπÑÏä§ Î≤ΩÎèå (ÌäπÏàò - Í∏àÏÉâ)
        const specialBrickTypes = [
            { icon: 'üöí', name: 'ÏÜåÎ∞©ÏÑú' },
            { icon: 'üöî', name: 'Í≤ΩÏ∞∞ÏÑú' },
            { icon: 'üè•', name: 'Î≥ëÏõê' },
            { icon: 'üè´', name: 'ÌïôÍµê' },
            { icon: 'üìö', name: 'ÎèÑÏÑúÍ¥Ä' },
            { icon: 'üå≥', name: 'Í≥µÏõê' }
        ];

        // ÌÄ¥Ï¶à Îç∞Ïù¥ÌÑ∞ (Í∞Å Í≥µÍ≥µÏÑúÎπÑÏä§Î≥Ñ ÌÄ¥Ï¶à + Î≥¥ÎÑàÏä§ ÌÄ¥Ï¶à)
        const facilityQuizzes = {
            'üöí': { 
                name: 'ÏÜåÎ∞©ÏÑú',
                question: 'ÏÜåÎ∞©ÏÑúÎäî ÏÑ∏Í∏àÏúºÎ°ú Ïö¥ÏòÅÎêòÎ©∞, ÌôîÏû¨ ÏßÑÏïïÍ≥º Íµ¨Ï°∞ ÌôúÎèôÏùÑ Îã¥ÎãπÌïúÎã§.',
                answer: true,
                explanation: 'ÏÜåÎ∞©ÏÑúÎäî ÌôîÏû¨ Îì± ÏúÑÌóòÌïú ÌòÑÏû•ÏóêÏÑú Íµ≠ÎØºÏùÑ Î≥¥Ìò∏ÌïòÎäî Í≥µÍ≥µ ÏÑúÎπÑÏä§Î•º Ï†úÍ≥µÌïòÎ©∞, Ïù¥Îäî Íµ≠ÎØºÏùò ÏÑ∏Í∏àÏúºÎ°ú Ïö¥ÏòÅÎê©ÎãàÎã§.'
            },
            'üöî': { 
                name: 'Í≤ΩÏ∞∞ÏÑú',
                question: 'Í≤ΩÏ∞∞ÏÑúÎäî ÎØºÍ∞Ñ Í∏∞ÏóÖÏù¥ Ïö¥ÏòÅÌïòÎ©∞, Ïù¥Ïö©Î£åÎ•º ÎÇ¥Ïïº ÌïúÎã§.',
                answer: false,
                explanation: 'Í≤ΩÏ∞∞ÏÑúÎäî ÍµêÌÜµÏÇ¨Í≥† ÎåÄÏùëÍ≥º Î≤îÏù∏ Ï≤¥Ìè¨ Îì± ÏúÑÌóòÌïú ÌòÑÏû•ÏóêÏÑú Íµ≠ÎØºÏùÑ Î≥¥Ìò∏ÌïòÎäî Í≥µÍ≥µ ÏÑúÎπÑÏä§Î•º Ï†úÍ≥µÌïòÎ©∞, Ïù¥Îü¨Ìïú ÏÑúÎπÑÏä§Îäî Íµ≠ÎØºÏùò ÏÑ∏Í∏àÏúºÎ°ú Ïö¥ÏòÅÎêòÏñ¥, Î™®Îì† Íµ≠ÎØºÏù¥ Î¨¥Î£åÎ°ú Î∞õÏùÑ Ïàò ÏûàÏäµÎãàÎã§.'
            },
            'üè•': { 
                name: 'Î≥ëÏõê',
                question: 'Í≥µÍ≥µ Î≥ëÏõêÍ≥º Î≥¥Í±¥ÏÜåÎäî ÏÑ∏Í∏àÏúºÎ°ú Ïö¥ÏòÅÎêòÏñ¥ Íµ≠ÎØº Í±¥Í∞ïÏùÑ ÏßÄÌÇ®Îã§.',
                answer: true,
                explanation: 'Î≥¥Í±¥ÏÜåÏôÄ Íµ≠Î¶ΩÎ≥ëÏõê Îì± Í≥µÍ≥µ ÏùòÎ£åÍ∏∞Í¥ÄÏùÄ Íµ≠ÎØºÏùò Í±¥Í∞ïÌïú ÏÇ∂ÏùÑ ÏúÑÌï¥ ÌïÑÏàò ÏùòÎ£å ÏÑúÎπÑÏä§Î•º Ï†úÍ≥µÌïòÎ©∞, Ïù¥Îü¨Ìïú ÏÑúÎπÑÏä§Îäî Íµ≠ÎØºÏùò ÏÑ∏Í∏àÏúºÎ°ú Ïö¥ÏòÅÎêòÏñ¥ Íµ≠ÎØºÏùò Í±¥Í∞ïÏùÑ ÏßÄÌÇ§Îäî Ïó≠Ìï†ÏùÑ Ìï©ÎãàÎã§.'
            },
            'üè´': { 
                name: 'ÌïôÍµê',
                question: 'Í≥µÎ¶ΩÌïôÍµêÏùò Î¨¥ÏÉÅÍµêÏú°Í≥º Í∏âÏãùÏùÄ ÏÑ∏Í∏àÏúºÎ°ú Ï†úÍ≥µÎêúÎã§.',
                answer: true,
                explanation: 'Í≥µÎ¶ΩÌïôÍµêÎäî Î¨¥ÏÉÅÍµêÏú°Í≥º ÌïôÍµê Í∏âÏãùÏùÑ Ï†úÍ≥µÌïòÎ©∞, Ïù¥Îü¨Ìïú ÏÑúÎπÑÏä§Îäî Íµ≠ÎØºÏù¥ ÎÇ©Î∂ÄÌïú ÏÑ∏Í∏àÏùÑ Ï£ºÏöî Ïû¨ÏõêÏúºÎ°ú Ïö¥ÏòÅÎê©ÎãàÎã§.'
            },
            'üìö': { 
                name: 'ÎèÑÏÑúÍ¥Ä',
                question: 'Í≥µÍ≥µ ÎèÑÏÑúÍ¥ÄÏùÄ ÏÑ∏Í∏àÏúºÎ°ú Ïö¥ÏòÅÎêòÏñ¥ ÎàÑÍµ¨ÎÇò Î¨¥Î£åÎ°ú Ïù¥Ïö©Ìï† Ïàò ÏûàÎã§.',
                answer: true,
                explanation: 'Í≥µÍ≥µ ÎèÑÏÑúÍ¥ÄÏùÄ Íµ≠ÎØºÏùò ÏÑ∏Í∏àÏúºÎ°ú Ïö¥ÏòÅÎêòÎ©∞, Î™®Îì† Íµ≠ÎØºÏóêÍ≤å ÌèâÎì±Ìïú ÍµêÏú°Í≥º Ï†ïÎ≥¥ Ïù¥Ïö© Í∏∞ÌöåÎ•º Ï†úÍ≥µÌïòÎäî Ïó≠Ìï†ÏùÑ Ìï©ÎãàÎã§.'
            },
            'üå≥': { 
                name: 'Í≥µÏõê',
                question: 'Í≥µÏõêÍ≥º Í∞ÄÎ°úÎì±ÏùÄ ÏÑ∏Í∏àÍ≥º Í¥ÄÍ≥ÑÏóÜÏù¥ ÎßåÎì§Ïñ¥ÏßÄÍ≥† Í¥ÄÎ¶¨ÎêúÎã§.',
                answer: false,
                explanation: 'Í≥µÏõê, Í∞ÄÎ°úÎì±, ÎèÑÎ°ú Îì± Í≥µÍ≥µÏãúÏÑ§ÏùÄ Íµ≠ÎØºÏù¥ ÎÇ∏ ÏÑ∏Í∏àÏúºÎ°ú ÎßåÎì§Ïñ¥ÏßÄÍ≥† Ïú†ÏßÄ¬∑Í¥ÄÎ¶¨Îê©ÎãàÎã§.'
            }
        };
        
        // ÍπúÎπ°ÏûÑ Ïï†ÎãàÎ©îÏù¥ÏÖòÏùÑ ÏúÑÌïú Î≥ÄÏàò
        let blinkTimer = 0;

        // Ï¥àÍ∏∞Ìôî
        function init() {
            canvas = document.getElementById('game-canvas');
            ctx = canvas.getContext('2d');
            
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
            
            // ÏûÖÎ†• Ïù¥Î≤§Ìä∏
            canvas.addEventListener('mousemove', handleMouseMove);
            canvas.addEventListener('touchmove', handleTouchMove, { passive: false });
            canvas.addEventListener('touchstart', handleTouchMove, { passive: false });
        }

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            canvasWidth = canvas.width;
            canvasHeight = canvas.height;
            
            // Ìå®Îì§ ÌÅ¨Í∏∞ Ï°∞Ï†ï
            CONFIG.PADDLE_WIDTH = Math.min(120, canvasWidth * 0.15);
            CONFIG.BALL_RADIUS = Math.max(6, Math.min(10, canvasWidth * 0.012));
            
            // Í≤åÏûÑ Ï§ëÏùº Îïå Î≤ΩÎèå Ïû¨Î∞∞Ïπò
            if (gameState.isPlaying && bricks && bricks.length > 0) {
                const brickWidth = (canvasWidth - CONFIG.BRICK_PADDING * (CONFIG.BRICK_COLS + 1)) / CONFIG.BRICK_COLS;
                const brickHeight = Math.min(35, canvasHeight * 0.045);
                let posIndex = 0;
                for (let row = 0; row < CONFIG.BRICK_ROWS; row++) {
                    for (let col = 0; col < CONFIG.BRICK_COLS; col++) {
                        if (posIndex < bricks.length) {
                            bricks[posIndex].x = CONFIG.BRICK_PADDING + col * (brickWidth + CONFIG.BRICK_PADDING);
                            bricks[posIndex].y = CONFIG.BRICK_TOP_OFFSET + row * (brickHeight + CONFIG.BRICK_PADDING);
                            bricks[posIndex].width = brickWidth;
                            bricks[posIndex].height = brickHeight;
                        }
                        posIndex++;
                    }
                }
                // Ìå®Îì§ ÏúÑÏπò Ï°∞Ï†ï
                if (paddle) {
                    paddle.width = CONFIG.PADDLE_WIDTH;
                    paddle.y = canvasHeight - 50;
                    if (paddle.x + paddle.width > canvasWidth) paddle.x = canvasWidth - paddle.width;
                }
                // Í≥µ ÏúÑÏπò Ï†úÌïú
                if (ball) {
                    if (ball.x > canvasWidth - ball.radius) ball.x = canvasWidth - ball.radius;
                    if (ball.y > canvasHeight - ball.radius) ball.y = canvasHeight - ball.radius;
                }
            }
        }

        function handleMouseMove(e) {
            if (!gameState.isPlaying || gameState.isPaused) return;
            const rect = canvas.getBoundingClientRect();
            paddle.x = e.clientX - rect.left - paddle.width / 2;
            clampPaddle();
        }

        function handleTouchMove(e) {
            if (!gameState.isPlaying || gameState.isPaused) return;
            e.preventDefault();
            const rect = canvas.getBoundingClientRect();
            const touch = e.touches[0];
            paddle.x = touch.clientX - rect.left - paddle.width / 2;
            clampPaddle();
        }

        function clampPaddle() {
            if (paddle.x < 0) paddle.x = 0;
            if (paddle.x + paddle.width > canvasWidth) paddle.x = canvasWidth - paddle.width;
        }

        function createBricks() {
            bricks = [];
            
            const brickWidth = (canvasWidth - CONFIG.BRICK_PADDING * (CONFIG.BRICK_COLS + 1)) / CONFIG.BRICK_COLS;
            const brickHeight = Math.min(35, canvasHeight * 0.045);
            
            // ÌäπÏàò Î≤ΩÎèå ÏúÑÏπò Í≤∞Ï†ï (6Í∞úÎ•º ÎûúÎç§ Î∞∞Ïπò)
            const totalPositions = CONFIG.BRICK_ROWS * CONFIG.BRICK_COLS;
            const specialPositions = [];
            while (specialPositions.length < 6) {
                const pos = Math.floor(Math.random() * totalPositions);
                if (!specialPositions.includes(pos)) {
                    specialPositions.push(pos);
                }
            }
            
            let specialIndex = 0;
            let positionIndex = 0;
            
            for (let row = 0; row < CONFIG.BRICK_ROWS; row++) {
                for (let col = 0; col < CONFIG.BRICK_COLS; col++) {
                    const x = CONFIG.BRICK_PADDING + col * (brickWidth + CONFIG.BRICK_PADDING);
                    const y = CONFIG.BRICK_TOP_OFFSET + row * (brickHeight + CONFIG.BRICK_PADDING);
                    
                    let brick;
                    
                    if (specialPositions.includes(positionIndex)) {
                        // ÌäπÏàò Î≤ΩÎèå (Í≥µÍ≥µÏÑúÎπÑÏä§)
                        const type = specialBrickTypes[specialIndex % specialBrickTypes.length];
                        brick = {
                            x, y,
                            width: brickWidth,
                            height: brickHeight,
                            isSpecial: true,
                            icon: type.icon,
                            name: type.name,
                            color: '#FFD700',
                            active: true
                        };
                        specialIndex++;
                    } else {
                        // ÏùºÎ∞ò Î≤ΩÎèå (Î∂ÄÏ†ïÏ†Å ÏöîÏÜå)
                        const type = negativeBrickTypes[Math.floor(Math.random() * negativeBrickTypes.length)];
                        brick = {
                            x, y,
                            width: brickWidth,
                            height: brickHeight,
                            isSpecial: false,
                            icon: type.icon,
                            name: type.name,
                            color: type.color,
                            active: true
                        };
                    }
                    
                    bricks.push(brick);
                    positionIndex++;
                }
            }
            
            gameState.totalBricks = bricks.length;
        }

        function createPaddle() {
            paddle = {
                x: canvasWidth / 2 - CONFIG.PADDLE_WIDTH / 2,
                y: canvasHeight - 50,
                width: CONFIG.PADDLE_WIDTH,
                height: CONFIG.PADDLE_HEIGHT
            };
        }

        function createBall() {
            ball = {
                x: canvasWidth / 2,
                y: paddle.y - CONFIG.BALL_RADIUS - 5,
                radius: CONFIG.BALL_RADIUS,
                dx: CONFIG.BALL_BASE_SPEED * (Math.random() > 0.5 ? 1 : -1),
                dy: -CONFIG.BALL_BASE_SPEED
            };
        }

        function startGame() {
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.add('active');
            
            resetGameState();
            createBricks();
            createPaddle();
            createBall();
            
            gameState.isPlaying = true;
            gameStartTime = Date.now();
            lastSpeedIncreaseTime = gameStartTime;
            
            updateHUD();
            gameLoop();
        }

        function resetGameState() {
            gameState.lives = CONFIG.LIVES;
            gameState.bricksDestroyed = 0;
            gameState.quizzesPassed = 0;
            gameState.speedMultiplier = 1;
            gameState.isPaused = false;
            gameState.currentQuizBrick = null;
            gameState.currentQuiz = null;
            particles = [];
            blinkTimer = 0;
        }

        function restartGame() {
            document.getElementById('result-screen').classList.remove('active', 'win', 'lose');
            document.getElementById('game-screen').classList.add('active');
            
            resetGameState();
            createBricks();
            createPaddle();
            createBall();
            
            gameState.isPlaying = true;
            gameStartTime = Date.now();
            lastSpeedIncreaseTime = gameStartTime;
            
            updateHUD();
            gameLoop();
        }

        function gameLoop() {
            if (!gameState.isPlaying) return;
            
            if (!gameState.isPaused) {
                update();
            }
            draw();
            
            requestAnimationFrame(gameLoop);
        }

        function update() {
            // ÍπúÎπ°ÏûÑ ÌÉÄÏù¥Î®∏ ÏóÖÎç∞Ïù¥Ìä∏
            blinkTimer += 0.1;
            
            // ÏÜçÎèÑ Ï¶ùÍ∞Ä Ï≤¥ÌÅ¨
            const now = Date.now();
            if (now - lastSpeedIncreaseTime > CONFIG.SPEED_INCREASE_INTERVAL) {
                gameState.speedMultiplier += CONFIG.SPEED_INCREASE_AMOUNT;
                lastSpeedIncreaseTime = now;
                updateHUD();
            }
            
            // Í≥µ Ïù¥Îèô
            const speed = gameState.speedMultiplier;
            ball.x += ball.dx * speed;
            ball.y += ball.dy * speed;
            
            // Î≤Ω Ï∂©Îèå
            if (ball.x - ball.radius < 0 || ball.x + ball.radius > canvasWidth) {
                ball.dx = -ball.dx;
                ball.x = Math.max(ball.radius, Math.min(canvasWidth - ball.radius, ball.x));
            }
            if (ball.y - ball.radius < 0) {
                ball.dy = -ball.dy;
                ball.y = ball.radius;
            }
            
            // Î∞îÎã• Ï∂©Îèå (ÏÉùÎ™Ö Í∞êÏÜå)
            if (ball.y + ball.radius > canvasHeight) {
                gameState.lives--;
                updateHUD();
                
                if (gameState.lives <= 0) {
                    gameOver(false);
                } else {
                    resetBall();
                }
            }
            
            // Ìå®Îì§ Ï∂©Îèå
            if (ball.y + ball.radius > paddle.y &&
                ball.y - ball.radius < paddle.y + paddle.height &&
                ball.x > paddle.x &&
                ball.x < paddle.x + paddle.width) {
                
                // Ìå®Îì§ ÏúÑÏπòÏóê Îî∞Î•∏ Î∞òÏÇ¨Í∞Å Ï°∞Ï†ï
                const hitPos = (ball.x - paddle.x) / paddle.width;
                const angle = (hitPos - 0.5) * Math.PI * 0.7;
                const speed = Math.sqrt(ball.dx * ball.dx + ball.dy * ball.dy);
                
                ball.dx = speed * Math.sin(angle);
                ball.dy = -Math.abs(speed * Math.cos(angle));
                ball.y = paddle.y - ball.radius;
                
                createParticles(ball.x, ball.y, '#4FC3F7', 5);
            }
            
            // Î≤ΩÎèå Ï∂©Îèå
            for (let brick of bricks) {
                if (!brick.active) continue;
                
                if (ball.x + ball.radius > brick.x &&
                    ball.x - ball.radius < brick.x + brick.width &&
                    ball.y + ball.radius > brick.y &&
                    ball.y - ball.radius < brick.y + brick.height) {
                    
                    // Ï∂©Îèå Î∞©Ìñ• Í≤∞Ï†ï
                    const overlapLeft = ball.x + ball.radius - brick.x;
                    const overlapRight = brick.x + brick.width - (ball.x - ball.radius);
                    const overlapTop = ball.y + ball.radius - brick.y;
                    const overlapBottom = brick.y + brick.height - (ball.y - ball.radius);
                    
                    const minOverlapX = Math.min(overlapLeft, overlapRight);
                    const minOverlapY = Math.min(overlapTop, overlapBottom);
                    
                    if (minOverlapX < minOverlapY) {
                        ball.dx = -ball.dx;
                    } else {
                        ball.dy = -ball.dy;
                    }
                    
                    if (brick.isSpecial) {
                        // ÌäπÏàò Î≤ΩÎèå: ÌÄ¥Ï¶à Î∞úÎèô
                        showQuiz(brick);
                    } else {
                        // ÏùºÎ∞ò Î≤ΩÎèå: ÌååÍ¥¥
                        destroyBrick(brick);
                    }
                    
                    break;
                }
            }
            
            // ÌååÌã∞ÌÅ¥ ÏóÖÎç∞Ïù¥Ìä∏
            particles = particles.filter(p => {
                p.x += p.vx;
                p.y += p.vy;
                p.vy += 0.2;
                p.life--;
                return p.life > 0;
            });
            
            // ÏäπÎ¶¨ Ï°∞Í±¥ Ï≤¥ÌÅ¨
            checkWinCondition();
        }

        function destroyBrick(brick, fromQuiz = false) {
            if (!brick.active) return;
            
            brick.active = false;
            gameState.bricksDestroyed++;
            createParticles(brick.x + brick.width / 2, brick.y + brick.height / 2, brick.color, 10);
            updateHUD();
        }

        function destroyAdjacentBricks(centerBrick) {
            const centerRow = Math.floor(bricks.indexOf(centerBrick) / CONFIG.BRICK_COLS);
            const centerCol = bricks.indexOf(centerBrick) % CONFIG.BRICK_COLS;
            
            // ÏÉÅÌïòÏ¢åÏö∞ Í∞Å 1Ïπ∏ (Ï¥ù 4Ïπ∏)
            const adjacentOffsets = [
                { row: -1, col: 0 },  // ÏúÑ
                { row: 1, col: 0 },   // ÏïÑÎûò
                { row: 0, col: -1 },  // ÏôºÏ™Ω
                { row: 0, col: 1 }    // Ïò§Î•∏Ï™Ω
            ];
            
            for (const offset of adjacentOffsets) {
                const newRow = centerRow + offset.row;
                const newCol = centerCol + offset.col;
                
                if (newRow >= 0 && newRow < CONFIG.BRICK_ROWS &&
                    newCol >= 0 && newCol < CONFIG.BRICK_COLS) {
                    const index = newRow * CONFIG.BRICK_COLS + newCol;
                    const brick = bricks[index];
                    if (brick && brick.active && !brick.isSpecial) {
                        setTimeout(() => destroyBrick(brick, true), 100);
                    }
                }
            }
        }

        function resetBall() {
            ball.x = paddle.x + paddle.width / 2;
            ball.y = paddle.y - ball.radius - 5;
            ball.dx = CONFIG.BALL_BASE_SPEED * (Math.random() > 0.5 ? 1 : -1);
            ball.dy = -CONFIG.BALL_BASE_SPEED;
        }

        function showQuiz(brick) {
            gameState.isPaused = true;
            gameState.currentQuizBrick = brick;
            
            document.getElementById('pause-indicator').textContent = 'ÌÄ¥Ï¶à ÌÉÄÏûÑ!';
            document.getElementById('pause-indicator').classList.add('show');
            
            // Ìï¥Îãπ Î≤ΩÎèåÏùò ÏïÑÏù¥ÏΩòÏóê ÎßûÎäî ÌÄ¥Ï¶à Í∞ÄÏ†∏Ïò§Í∏∞
            const quiz = facilityQuizzes[brick.icon];
            gameState.currentQuiz = quiz;
            gameState.currentQuizIcon = brick.icon;
            
            document.getElementById('quiz-facility').textContent = brick.icon;
            document.getElementById('quiz-title').textContent = `${quiz.name} ÌÄ¥Ï¶à!`;
            document.getElementById('quiz-question').textContent = quiz.question;
            document.getElementById('quiz-result').className = 'quiz-result';
            document.getElementById('quiz-result').innerHTML = '';
            document.getElementById('quiz-buttons').style.display = 'flex';
            
            setTimeout(() => {
                document.getElementById('pause-indicator').classList.remove('show');
                document.getElementById('quiz-modal').classList.add('active');
            }, 500);
        }

        function answerQuiz(answer) {
            const quiz = gameState.currentQuiz;
            const resultDiv = document.getElementById('quiz-result');
            const buttonsDiv = document.getElementById('quiz-buttons');
            
            if (answer === quiz.answer) {
                // Ï†ïÎãµ
                resultDiv.className = 'quiz-result correct';
                resultDiv.innerHTML = `
                    <p>üéâ Ï†ïÎãµÏù¥ÏóêÏöî!</p>
                    <p style="margin-top: 6px; font-weight: normal; font-size: 0.9em;">${quiz.explanation}</p>
                    <button class="result-btn continue" onclick="closeQuiz(true)">Í≥ÑÏÜçÌïòÍ∏∞</button>
                `;
                buttonsDiv.style.display = 'none';
            } else {
                // Ïò§Îãµ
                resultDiv.className = 'quiz-result wrong';
                resultDiv.innerHTML = `
                    <p>‚ùå ÌãÄÎ†∏Ïñ¥Ïöî!</p>
                    <p style="margin-top: 6px; font-weight: normal; font-size: 0.9em;">Îã§Ïãú ÏÉùÍ∞ÅÌï¥Î≥¥ÏÑ∏Ïöî!</p>
                    <button class="result-btn retry" onclick="retryQuiz()">Îã§Ïãú ÌíÄÍ∏∞</button>
                `;
                buttonsDiv.style.display = 'none';
            }
        }

        function retryQuiz() {
            document.getElementById('quiz-result').className = 'quiz-result';
            document.getElementById('quiz-result').innerHTML = '';
            document.getElementById('quiz-buttons').style.display = 'flex';
        }

        function closeQuiz(success) {
            document.getElementById('quiz-modal').classList.remove('active');
            
            const brick = gameState.currentQuizBrick;
            
            if (success && brick) {
                gameState.quizzesPassed++;
                
                // ÌäπÏàò Î≤ΩÎèå ÌååÍ¥¥
                destroyBrick(brick);
                
                // Ïù∏Ï†ë Î≤ΩÎèå ÌååÍ¥¥
                destroyAdjacentBricks(brick);
                
                updateHUD();
            }
            
            gameState.isPaused = false;
            gameState.currentQuizBrick = null;
            gameState.currentQuiz = null;
            
            // ÏäπÎ¶¨ Ï°∞Í±¥ Ï≤¥ÌÅ¨
            setTimeout(() => checkWinCondition(), 200);
        }

        function checkWinCondition() {
            const activeBricks = bricks.filter(b => b.active).length;
            
            if (activeBricks === 0 && gameState.quizzesPassed >= gameState.totalQuizzes) {
                gameOver(true);
            }
        }

        function gameOver(isWin) {
            gameState.isPlaying = false;
            
            document.getElementById('game-screen').classList.remove('active');
            const resultScreen = document.getElementById('result-screen');
            resultScreen.classList.add('active');
            resultScreen.classList.add(isWin ? 'win' : 'lose');
            
            document.getElementById('result-title').textContent = isWin ? 'üéâ Í≤åÏûÑ ÌÅ¥Î¶¨Ïñ¥!' : 'üò¢ Í≤åÏûÑ Ïò§Î≤Ñ';
            document.getElementById('final-quiz').textContent = gameState.quizzesPassed;
            document.getElementById('final-bricks').textContent = gameState.bricksDestroyed;
            document.getElementById('final-lives').textContent = gameState.lives;
            document.getElementById('achievement-badge').textContent = isWin ? 'üèÜ ÎßàÏùÑÏùò ÏòÅÏõÖ!' : 'Îã§Ïãú ÎèÑÏ†ÑÌï¥Î≥¥ÏÑ∏Ïöî!';
        }

        function togglePause() {
            if (!gameState.isPlaying) return;
            
            gameState.isPaused = !gameState.isPaused;
            const pauseBtn = document.getElementById('pause-btn');
            const pauseIndicator = document.getElementById('pause-indicator');
            const pauseOverlay = document.getElementById('pause-overlay');
            
            if (gameState.isPaused) {
                pauseBtn.textContent = 'Í≥ÑÏÜçÌïòÍ∏∞';
                pauseOverlay.classList.add('active');
            } else {
                pauseBtn.textContent = 'ÏùºÏãúÏ†ïÏßÄ';
                pauseOverlay.classList.remove('active');
                pauseIndicator.classList.remove('show');
            }
        }

        function restartFromPause() {
            gameState.isPaused = false;
            gameState.isPlaying = false;
            document.getElementById('pause-overlay').classList.remove('active');
            document.getElementById('pause-btn').textContent = 'ÏùºÏãúÏ†ïÏßÄ';
            document.getElementById('pause-indicator').classList.remove('show');
            document.getElementById('game-screen').classList.remove('active');
            document.getElementById('start-screen').classList.remove('hidden');
        }

        function exitGame() {
            window.close();
            // window.close()Í∞Ä ÏûëÎèôÌïòÏßÄ ÏïäÎäî Í≤ΩÏö∞Î•º ÏúÑÌïú ÎåÄÏ≤¥ Î∞©Î≤ï
            if (!window.closed) {
                window.location.href = 'about:blank';
            }
        }

        function updateHUD() {
            document.getElementById('lives-display').textContent = gameState.lives;
            document.getElementById('bricks-display').textContent = `${gameState.bricksDestroyed}/${gameState.totalBricks}`;
            document.getElementById('quiz-display').textContent = `${gameState.quizzesPassed}/${gameState.totalQuizzes}`;
            document.getElementById('speed-display').textContent = `${gameState.speedMultiplier.toFixed(1)}x`;
        }

        function createParticles(x, y, color, count) {
            for (let i = 0; i < count; i++) {
                particles.push({
                    x: x,
                    y: y,
                    vx: (Math.random() - 0.5) * 8,
                    vy: (Math.random() - 0.5) * 8,
                    color: color,
                    size: Math.random() * 4 + 2,
                    life: 30
                });
            }
        }

        function draw() {
            // Î∞∞Í≤Ω
            ctx.fillStyle = '#1a1a2e';
            ctx.fillRect(0, 0, canvasWidth, canvasHeight);
            
            // Î∞∞Í≤Ω Í∑∏ÎùºÎç∞Ïù¥ÏÖò
            const gradient = ctx.createLinearGradient(0, 0, 0, canvasHeight);
            gradient.addColorStop(0, 'rgba(26, 26, 46, 1)');
            gradient.addColorStop(1, 'rgba(22, 33, 62, 1)');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvasWidth, canvasHeight);
            
            // Î≤ΩÎèå
            for (const brick of bricks) {
                if (!brick.active) continue;
                
                // ÌäπÏàò Î≤ΩÎèå ÍπúÎπ°ÏûÑ Ìö®Í≥º
                let brickAlpha = 1;
                if (brick.isSpecial) {
                    brickAlpha = 0.6 + 0.4 * Math.abs(Math.sin(blinkTimer * 3));
                }
                
                // Î≤ΩÎèå Î∞∞Í≤Ω
                ctx.globalAlpha = brickAlpha;
                ctx.fillStyle = brick.color;
                ctx.beginPath();
                ctx.roundRect(brick.x, brick.y, brick.width, brick.height, 5);
                ctx.fill();
                
                // ÌäπÏàò Î≤ΩÎèå ÌÖåÎëêÎ¶¨ (Í∏àÏÉâ Í∞ïÏ°∞)
                if (brick.isSpecial) {
                    // Ïô∏Í≥Ω Í∏ÄÎ°úÏö∞ Ìö®Í≥º
                    ctx.shadowColor = '#FFD700';
                    ctx.shadowBlur = 15 + 5 * Math.sin(blinkTimer * 3);
                    ctx.strokeStyle = '#FFF';
                    ctx.lineWidth = 3;
                    ctx.stroke();
                    ctx.shadowBlur = 0;
                }
                
                ctx.globalAlpha = 1;
                
                // ÏïÑÏù¥ÏΩò
                ctx.font = `${Math.min(brick.height * 0.7, 20)}px sans-serif`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(brick.icon, brick.x + brick.width / 2, brick.y + brick.height / 2);
            }
            
            // Ìå®Îì§
            ctx.fillStyle = '#4FC3F7';
            ctx.beginPath();
            ctx.roundRect(paddle.x, paddle.y, paddle.width, paddle.height, 8);
            ctx.fill();
            
            // Ìå®Îì§ ÌïòÏù¥ÎùºÏù¥Ìä∏
            ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
            ctx.beginPath();
            ctx.roundRect(paddle.x + 5, paddle.y + 2, paddle.width - 10, 5, 3);
            ctx.fill();
            
            // Í≥µ
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
            ctx.fillStyle = '#FFF';
            ctx.fill();
            
            // Í≥µ Í∑∏Î¶ºÏûê
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, ball.radius + 3, 0, Math.PI * 2);
            ctx.fillStyle = 'rgba(255, 255, 255, 0.2)';
            ctx.fill();
            
            // ÌååÌã∞ÌÅ¥
            for (const p of particles) {
                ctx.globalAlpha = p.life / 30;
                ctx.fillStyle = p.color;
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                ctx.fill();
            }
            ctx.globalAlpha = 1;
        }

        // ÏãúÏûë
        window.addEventListener('load', init);
    </script>
</body>
</html>
